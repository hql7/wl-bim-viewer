/*!
 * LMV v7.15.1
 * 
 * Copyright 2020 Autodesk, Inc.
 * All rights reserved.
 * 
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 * 
 * Autodesk Forge Viewer Usage Limitations:
 * 
 * The Autodesk Forge viewer can only be used to view files generated by
 * Autodesk Forge services. The Autodesk Forge Viewer JavaScript must be
 * delivered from an Autodesk hosted URL.
 */
Autodesk.Extensions.Measure=function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=556)}({14:function(e,t){e.exports=function(e){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)?'"'+e.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':e)}},3:function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",n=e[3];if(!n)return i;if(t&&"function"==typeof btoa){var s=(r=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),a=n.sources.map((function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"}));return[i].concat(a).concat([s]).join("\n")}var r;return[i].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i})).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},s=0;s<this.length;s++){var a=this[s][0];"number"==typeof a&&(n[a]=!0)}for(s=0;s<e.length;s++){var r=e[s];"number"==typeof r[0]&&n[r[0]]||(i&&!r[2]?r[2]=i:i&&(r[2]="("+r[2]+") and ("+i+")"),t.push(r))}},t}},344:function(e,t,i){var n=i(345);"string"==typeof n&&(n=[[e.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i(4)(n,s);n.locals&&(e.exports=n.locals)},345:function(e,t,i){var n=i(14);(e.exports=i(3)(!1)).push([e.i,".adsk-viewing-viewer .measure-length:hover.measure-length.enable-hover{box-shadow:0 0 16px 3px rgba(0,117,210,0.7);-webkit-box-shadow:0 0 16px 3px rgba(0,117,210,0.7);-moz-box-shadow:0 0 16px 3px rgba(0,117,210,0.7)}.adsk-viewing-viewer .measure-length{display:none;position:absolute;height:19px;left:0px;top:0px;padding:2px 0 2px 0;background-color:#009bff;box-shadow:0px 1px 3px 1px rgba(0,0,0,0.25);color:#f4f4f4;font-size:12px;text-align:center;line-height:1.2;white-space:nowrap;border-radius:8px;pointer-events:none;cursor:pointer;z-index:2;-webkit-tap-highlight-color:rgba(0,0,0,0)}.adsk-viewing-viewer .measure-length.visible{display:block}.adsk-viewing-viewer .measure-length.fetching-topology{background-color:rgba(34,34,34,0.8);box-shadow:0 0.5px 1.5px 0 rgba(0,0,0,0.3)}.adsk-viewing-viewer .measure-length-text{display:inline-block;margin:0 5px 0 5px;vertical-align:middle;font-size:16px;pointer-events:none}.adsk-viewing-viewer .measure-delta-text{margin:0 5px 0 5px;align-self:center;font-size:14px;overflow:hidden;white-space:nowrap;height:16px;line-height:16px;vertical-align:middle;pointer-events:none}.adsk-viewing-viewer .measure-length-button{display:inline-block;width:16px;height:16px;font-size:16px;float:right;color:#FFFFFF;opacity:0.7}.adsk-viewing-viewer .measure-length-button:hover{background-color:rgba(166,194,255,0.7);-webkit-transition:all 0.2s ease;-moz-transition:all 0.2s ease;-ms-transition:all 0.2s ease;-o-transition:all 0.2s ease;transition:all 0.2s ease}.adsk-viewing-viewer .measure-label:hover.measure-label.enable-hover,.adsk-viewing-viewer .measure-label.on-edit{box-shadow:0 0 4px 4px #0d69ca;-webkit-box-shadow:0 0 4px 4px #0d69ca;-moz-box-shadow:0 0 4px 4px #0d69ca}.adsk-viewing-viewer .measure-label.editable{pointer-events:all}.adsk-viewing-viewer .measure-label{display:none;position:absolute;width:7px;height:7px;cursor:move;pointer-events:none;border-radius:100px}.adsk-viewing-viewer .measure-label-hit-area{display:inline-block;position:absolute;width:44px;height:44px;left:-22px;top:-22px;border-radius:100px;z-index:2}.adsk-viewing-viewer .measure-label-icon{display:inline-block;position:absolute;width:7px;height:7px;left:-2px;top:-2px;background-color:#009bff;border-style:solid;border-width:2px;border-color:#FFFFFF;border-radius:100px;box-shadow:0 2px 5px 0 #182A3D;z-index:2}.adsk-viewing-viewer .measure-label.visible{display:block}.adsk-viewing-viewer .measure-label-text{display:inline-block;margin:0px 5px 0px 5px;vertical-align:middle}.adsk-viewing-viewer .measure-horizontal-divider{height:1px;border-top:1px solid rgba(200,200,200,0.8)}.adsk-viewing-viewer .measure-submenu-select{display:block;position:relative;width:calc(100% - 40px);padding:10px 20px 0px 20px;opacity:0.3}.adsk-viewing-viewer .option-drop-down:disabled{opacity:0.3}.adsk-viewing-viewer .measure-submenu-selectlabel{position:relative;display:inline-block;padding-right:20px;padding-bottom:4px}.adsk-viewing-viewer .measure-results{position:relative;display:block;padding:5px 0px  10px 30px}.adsk-viewing-viewer .measure-result-label{display:inline-block;padding-right:10px}.adsk-viewing-viewer .measure-result-number{display:inline-block}.adsk-viewing-viewer .measure-delta-collapse{position:absolute;right:20px;display:inline-block;background-color:rgba(255,255,255,0.12);margin:0px 4px 0px 4px;padding:0px 4px 0px 4px;cursor:pointer;text-align:center}.adsk-viewing-viewer .measure-delta-collapse:hover{background-color:rgba(166,194,255,0.7);-webkit-transition:all 0.2s ease;-moz-transition:all 0.2s ease;-ms-transition:all 0.2s ease;-o-transition:all 0.2s ease;transition:all 0.2s ease}.adsk-viewing-viewer .measure-selection-repick{position:absolute;right:20px;display:inline-block;background-color:rgba(255,255,255,0.12);margin:4px 4px 4px 4px;padding:4px 4px 4px 4px;cursor:pointer;text-align:center}.adsk-viewing-viewer .measure-selection-repick:hover{background-color:rgba(166,194,255,0.7);-webkit-transition:all 0.2s ease;-moz-transition:all 0.2s ease;-ms-transition:all 0.2s ease;-o-transition:all 0.2s ease;transition:all 0.2s ease}.adsk-viewing-viewer .measure-restart{margin:10px 20px 15px 20px;padding:6px 10px 6px 10px;width:calc(100% - 55px);cursor:pointer;text-align:center;border-style:solid;border-width:1px;border-color:rgba(255,255,255,0.2);border-radius:3px}.adsk-viewing-viewer .docking-panel:hover .measure-restart{background-color:rgba(255,255,255,0.12)}.adsk-viewing-viewer .docking-panel .measure-restart:hover{background-color:rgba(166,194,255,0.7);-webkit-transition:all 0.2s ease;-moz-transition:all 0.2s ease;-ms-transition:all 0.2s ease;-o-transition:all 0.2s ease;transition:all 0.2s ease}.adsk-viewing-viewer .measure-panel-title{padding-top:0px;padding-left:20px;margin-top:10px}.adsk-viewing-viewer .measure-panel-title:hover{cursor:pointer}.adsk-viewing-viewer .measure-panel-title.collapsed{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkEwMDhBMzY4QTYyODExRTM5REY0Q0MwMTM3MTVFOTMzIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkEwMDhBMzY5QTYyODExRTM5REY0Q0MwMTM3MTVFOTMzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QTAwOEEzNjZBNjI4MTFFMzlERjRDQzAxMzcxNUU5MzMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QTAwOEEzNjdBNjI4MTFFMzlERjRDQzAxMzcxNUU5MzMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6WHWu4AAAAcElEQVR42mL8//8/AzmAiYFMgEtjGSFDcUmGAfEEIOYix6lWQLwUiGXJ8SNI00IgNiIncPiAeCoQ+5ITqsxQA+CAhQhN34C4AoiPkaLxGRAXAfEdUvx4DohjsGkCA1CSw4LrgZgVhxwYM9I9rQIEGACZNDs01yUXlAAAAABJRU5ErkJggg==);background-repeat:no-repeat}.adsk-viewing-viewer .measure-panel-title.expanded{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkE3QzFFQUQ1QTYyODExRTM5NzE2RjcyN0QxQjg0QTREIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkE3QzFFQUQ2QTYyODExRTM5NzE2RjcyN0QxQjg0QTREIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QTdDMUVBRDNBNjI4MTFFMzk3MTZGNzI3RDFCODRBNEQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QTdDMUVBRDRBNjI4MTFFMzk3MTZGNzI3RDFCODRBNEQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6XuY60AAAARklEQVR42mL8//8/AzmAiYFMQBeNqSg8kB+JwKlAfAZZjIlIm9JJdSpWTYQ04tSETyNeTbg0EtSETSNRmkCAcegkOYAAAwDGjDZHvY373AAAAABJRU5ErkJggg==);background-repeat:no-repeat}.adsk-viewing-viewer .adsk-viewing-viewer .measure-table td{padding:10px 0px  10px 20px}.adsk-viewing-viewer .measure-selection-one-label{display:inline-block;margin:18px 18px 18px 18px;width:16px;height:16px;font-size:16px;float:left;padding:2px;background-color:#0033FF;border-radius:10px;opacity:0.6}.adsk-viewing-viewer .measure-selection-two-label{display:inline-block;margin:18px 18px 18px 18px;width:16px;height:16px;font-size:16px;float:left;padding:2px;background-color:#0033FF;border-radius:10px;opacity:0.6}.adsk-viewing-viewer .measure-repick{display:inline-block;cursor:default;margin:20px 20px 20px 20px;width:16px;height:16px;font-size:16px;float:right;opacity:0.5}.adsk-viewing-viewer .measure-repick:hover{opacity:1}.adsk-viewing-viewer .measure-selection-result{display:inline-block;margin:21px 0px 21px 0px}.adsk-viewing-viewer .measure-distance-icon{display:inline-block;margin:20px 2px 20px 2px;font-size:52px;color:#FF9900;float:left}.adsk-viewing-viewer .measure-angle-icon{display:inline-block;margin:20px 2px 20px 2px;font-size:52px;color:#FF9900;float:left}.adsk-viewing-viewer .adsk-viewing-viewer .measure-result{font-size:20px;color:#FF9900;display:inline-block;margin:38px 0px 38px 0px}.adsk-viewing-viewer .measure-initial{font-size:20px;display:inline-block;margin:38px 0px 38px 56px}.adsk-viewing-viewer .measure-settings-button{cursor:default;position:relative;top:20px;right:20px;width:16px;height:16px;font-size:18px;float:right;opacity:0.5}.adsk-viewing-viewer .measure-settings-button:hover{opacity:1}.adsk-viewing-viewer .measure-delta-button{position:relative;top:56px;right:4px;width:16px;height:16px;font-size:16px;float:right;opacity:0.5;-webkit-transform:rotate(-90deg);-moz-transform:rotate(-90deg);-ms-transform:rotate(-90deg);-o-transform:rotate(-90deg);transform:rotate(-90deg)}.adsk-viewing-viewer .measure-delta-button.rotated{-webkit-transform:rotate(90deg);-moz-transform:rotate(90deg);-ms-transform:rotate(90deg);-o-transform:rotate(90deg);transform:rotate(90deg)}.adsk-viewing-viewer .measure-delta-button:hover{opacity:1}.adsk-viewing-viewer .measure-delta-result{display:inline-block;margin:0px 0px 20px 0px;padding:0px 0px 0px 56px}.adsk-viewing-viewer .measure-label-axis{display:none;position:absolute;width:16px;height:16px;left:0px;top:0px;background-color:#f4f4f4;border-radius:8px;pointer-events:none}.adsk-viewing-viewer .measure-label-axis-icon.X{background-color:#EC4545}.adsk-viewing-viewer .measure-label-axis-icon.Y{background-color:#45C345}.adsk-viewing-viewer .measure-label-axis-icon.Z{background-color:#5757DA}.adsk-viewing-viewer .measure-label-axis-icon{width:20px;height:18px;color:#f4f4f4;border-radius:8px 0 0 8px;font-size:12px;padding-top:4px;line-height:15px;text-align:center}.adsk-viewing-viewer .measure-label-axis-delta.enableTransition{transition:opacity 0.1s linear}.adsk-viewing-viewer .measure-label-axis-delta{display:none;position:absolute;font-size:18px;left:0px;top:0px;background-color:#ffffff;pointer-events:none;opacity:0;border-radius:8px;box-shadow:0px 1px 3px 1px rgba(0,0,0,0.25)}.adsk-viewing-viewer .measure-label-axis.visible{display:block}.adsk-viewing-viewer .measure-label-axis-delta.visible{display:flex}.adsk-viewing-viewer .measure-label-axis-x{color:#EC4545}.adsk-viewing-viewer .measure-label-axis-y{color:#45C345}.adsk-viewing-viewer .measure-label-axis-z{color:#5757DA}.adsk-viewing-viewer .magnifying-glass.visible{display:block}.adsk-viewing-viewer .magnifying-glass{position:absolute;display:none;-moz-border-radius:100%;-webkit-border-radius:100%;border-radius:100%;background:transparent;box-shadow:2px 2px 4px rgba(0,0,0,0.5),inset 2px 2px 4px rgba(0,0,0,0.5);-webkit-box-shadow:2px 2px 4px rgba(0,0,0,0.5),inset 2px 2px 4px rgba(0,0,0,0.5);-moz-box-shadow:2px 2px 4px rgba(0,0,0,0.5),inset 2px 2px 4px rgba(0,0,0,0.5);z-index:4}.adsk-viewing-viewer .measure-fetching-topology{display:inline-block;width:10px;height:10px;background:url("+n(i(346))+");margin:3px 0px -2px 3px;animation:measure-topology-fetching-anim 1.4s infinite linear;-webkit-animation:measure-topology-fetching-anim 1.4s infinite linear}@keyframes measure-topology-fetching-anim{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes measure-topology-fetching-anim{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.adsk-viewing-viewer .docking-panel.measure-settings-popup{display:flex;justify-content:center;flex-direction:column;bottom:120%;box-sizing:border-box;text-align:left;position:absolute;padding-top:15px;padding-bottom:15px}.adsk-viewing-viewer .adsk-toolbar-vertical .docking-panel.measure-settings-popup{right:120%;bottom:unset;height:max-content;width:max-content}.adsk-viewing-viewer .docking-panel.measure-settings-popup .adsk-lmv-tftable tr.switch-slider-row td{width:auto;padding-bottom:0px;padding-top:0px;vertical-align:inherit}.adsk-viewing-viewer .docking-panel.measure-settings-popup.hide{display:none}.adsk-viewing-viewer .measure-settings-popup tbody{top:15px}.adsk-toolbar .measure-toolbar-seperator{height:18px;width:1px;background-color:#999;float:left;margin:16px 5px}.adsk-toolbar.adsk-toolbar-vertical .measure-toolbar-seperator{height:1px;width:18px;margin:5px 16px}.adsk-viewing-viewer .measure-selection-area{display:block;position:absolute;cursor:pointer;z-index:1;-webkit-tap-highlight-color:rgba(0,0,0,0)}\n",""])},346:function(e,t){e.exports="\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='10' height='10' viewBox='0 0 10 10'%3E %3Cdefs%3E %3ClinearGradient id='linear-gradient' y1='5' x2='10' y2='5' gradientUnits='userSpaceOnUse'%3E %3Cstop offset='0' stop-color='%23fff' stop-opacity='0'/%3E %3Cstop offset='1' stop-color='%23fff'/%3E %3C/linearGradient%3E %3C/defs%3E %3Ctitle%3EAsset 6%3C/title%3E %3Cg id='Layer_2' data-name='Layer 2'%3E %3Cg id='finals_24px'%3E %3Cpath d='M5,10A5,5,0,0,1,0,5,1.2,1.2,0,0,1,2.3,5,2.7,2.7,0,1,0,5,2.3,1.2,1.2,0,0,1,5,0,5,5,0,0,1,5,10Z' fill='url(%23linear-gradient)'/%3E %3C/g%3E %3C/g%3E %3C/svg%3E\""},347:function(e,t,i){var n=i(348);"string"==typeof n&&(n=[[e.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i(4)(n,s);n.locals&&(e.exports=n.locals)},348:function(e,t,i){(e.exports=i(3)(!1)).push([e.i,"@font-face{font-family:'calibration-icon';src:url(\"data:application/octet-stream;base64,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\") format(\"woff\");font-weight:normal;font-style:normal}[class^=\"calibration-icon\"],[class*=\" calibration-icon\"]{font-family:'calibration-icon';font-style:normal;font-weight:normal;font-variant:normal;line-height:1;padding-top:2px;speak:none;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.adsk-viewing-viewer .calibration-icon:before{content:'a'}.adsk-viewing-viewer .calibration-panel{left:calc(50% - 190px);top:calc(50% - 145px);width:300px;height:auto;z-index:4}.adsk-viewing-viewer .measure-settings-popup .option-drop-down,.adsk-viewing-viewer .calibration-panel .option-drop-down{width:100%;padding-right:0px;box-sizing:border-box}.adsk-viewing-viewer .measure-settings-popup .adsk-lmv-tftable tr td,.adsk-viewing-viewer .calibration-panel .adsk-lmv-tftable tr td{width:auto;padding:2px 15px 2px 0px}.adsk-viewing-viewer .calibration-panel .adsk-lmv-tftable tr td input{margin:0px;box-sizing:border-box;width:100%}.adsk-viewing-viewer .measure-settings-popup .switch{margin-left:25px}.adsk-viewing-viewer .measure-settings-popup .switch .slider{width:26px}.adsk-viewing-viewer .calibration-textbox::-webkit-inner-spin-button,.adsk-viewing-viewer .calibration-textbox::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.adsk-viewing-viewer .calibration-text{text-align:left;padding:6px 10px 6px 10px;margin:20px 20px 14px 20px;font-size:14px;-webkit-font-smoothing:antialiased}.adsk-viewing-viewer .calibration-button{margin-top:15px}.adsk-viewing-viewer .calibration-button-left{width:calc(50% - 15px);margin-right:5px !important;display:inline-block}.adsk-viewing-viewer .calibration-button-right{width:calc(50% - 15px);margin-left:5px !important;display:inline-block}.adsk-viewing-viewer .calibration-line{position:absolute;display:block;top:0;left:0;pointer-events:none;z-index:0}.adsk-viewing-viewer .calibration-label{display:none;position:absolute;pointer-events:none;text-align:'center';vertical-align:middle;cursor:default;padding:2px;color:#000000;background:#FFFFFF;border-radius:10px;-webkit-transform-origin:50%  53%}.adsk-viewing-viewer .calibration-label-text{display:inline-block;pointer-events:none;text-align:'center';vertical-align:middle;font-size:12px;cursor:default;padding:2px;color:#000000;background:#FFFFFF;border-bottom:1px dashed #000000;text-decoration:none;text-transform:uppercase;-webkit-font-smoothing:antialiased}.adsk-viewing-viewer .calibration-label-text:hover{color:#039be5;border-bottom:1px dashed #039be5}.adsk-viewing-viewer .calibration-label.visible{display:block}.adsk-viewing-viewer .calibration-endpoint:hover.calibration-endpoint.enable-hover,.adsk-viewing-viewer .calibration-endpoint.edit{background-color:#039be5}.adsk-viewing-viewer .calibration-endpoint:hover.calibration-endpoint.enable-hover>*,.adsk-viewing-viewer .calibration-endpoint.edit>*{color:#ffffff}.adsk-viewing-viewer .calibration-endpoint.editable{pointer-events:all}.adsk-viewing-viewer .calibration-endpoint{display:none;position:absolute;cursor:move;pointer-events:none;width:30px;height:30px;background-color:#ffffff;box-shadow:0 4px 8px 0 rgba(0,0,0,0.24),0 0 8px 0 rgba(0,0,0,0.12);-moz-border-radius:50px;-webkit-border-radius:50px;border-radius:50px;justify-content:center;align-items:center;text-align:center}.adsk-viewing-viewer .calibration-endpoint.visible{display:block}.adsk-viewing-viewer .calibration-endpoint-text{display:inline-block;font-size:14px;vertical-align:middle;cursor:default;margin:5px 5px 5px 5px;vertical-align:middle;text-align:center;color:#039be5;text-decoration:none;text-transform:uppercase;pointer-events:none}.adsk-viewing-viewer .calibration-buttons-wrapper{text-align:center}\n",""])},4:function(e,t,i){var n,s,a={},r=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===s&&(s=n.apply(this,arguments)),s}),o=function(e,t){return t?t.querySelector(e):document.querySelector(e)},l=function(e){var t={};return function(e,i){if("function"==typeof e)return e();if(void 0===t[e]){var n=o.call(this,e,i);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),h=null,c=0,u=[],d=i(6);function p(e,t){for(var i=0;i<e.length;i++){var n=e[i],s=a[n.id];if(s){s.refs++;for(var r=0;r<s.parts.length;r++)s.parts[r](n.parts[r]);for(;r<n.parts.length;r++)s.parts.push(A(n.parts[r],t))}else{var o=[];for(r=0;r<n.parts.length;r++)o.push(A(n.parts[r],t));a[n.id]={id:n.id,refs:1,parts:o}}}}function m(e,t){for(var i=[],n={},s=0;s<e.length;s++){var a=e[s],r=t.base?a[0]+t.base:a[0],o={css:a[1],media:a[2],sourceMap:a[3]};n[r]?n[r].parts.push(o):i.push(n[r]={id:r,parts:[o]})}return i}function g(e,t){var i=l(e.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=u[u.length-1];if("top"===e.insertAt)n?n.nextSibling?i.insertBefore(t,n.nextSibling):i.appendChild(t):i.insertBefore(t,i.firstChild),u.push(t);else if("bottom"===e.insertAt)i.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var s=l(e.insertAt.before,i);i.insertBefore(t,s)}}function b(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=u.indexOf(e);t>=0&&u.splice(t,1)}function v(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var n=function(){0;return i.nc}();n&&(e.attrs.nonce=n)}return f(t,e.attrs),g(e,t),t}function f(e,t){Object.keys(t).forEach((function(i){e.setAttribute(i,t[i])}))}function A(e,t){var i,n,s,a;if(t.transform&&e.css){if(!(a="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=a}if(t.singleton){var r=c++;i=h||(h=v(t)),n=E.bind(null,i,r,!1),s=E.bind(null,i,r,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",f(t,e.attrs),g(e,t),t}(t),n=M.bind(null,i,t),s=function(){b(i),i.href&&URL.revokeObjectURL(i.href)}):(i=v(t),n=x.bind(null,i),s=function(){b(i)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else s()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=r()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var i=m(e,t);return p(i,t),function(e){for(var n=[],s=0;s<i.length;s++){var r=i[s];(o=a[r.id]).refs--,n.push(o)}e&&p(m(e,t),t);for(s=0;s<n.length;s++){var o;if(0===(o=n[s]).refs){for(var l=0;l<o.parts.length;l++)o.parts[l]();delete a[o.id]}}}};var y,w=(y=[],function(e,t){return y[e]=t,y.filter(Boolean).join("\n")});function E(e,t,i,n){var s=i?"":n.css;if(e.styleSheet)e.styleSheet.cssText=w(t,s);else{var a=document.createTextNode(s),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(a,r[t]):e.appendChild(a)}}function x(e,t){var i=t.css,n=t.media;if(n&&e.setAttribute("media",n),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}function M(e,t,i){var n=i.css,s=i.sourceMap,a=void 0===t.convertToAbsoluteUrls&&s;(t.convertToAbsoluteUrls||a)&&(n=d(n)),s&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */");var r=new Blob([n],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(r),o&&URL.revokeObjectURL(o)}},556:function(e,t,i){"use strict";i.r(t);var n=Autodesk.Viewing.MeasureCommon;function s(e){this.viewer=e,this.init(),this.restoredMeasurementData=[]}var a=s.prototype;a.getCurrentMeasurement=function(){return this.currentMeasurement},a.getRestoredMeasurementData=function(){return this.restoredMeasurementData.slice()},a.selectMeasurementById=function(e){var t=this.measurementsList[e];return!!t&&(this.changeCurrentMeasurement(t),this.currentMeasurement)},a.createMeasurement=function(e){var t=this.measurementsCounter,i=new n.Measurement(e,t);return this.measurementsList[t]=i,this.measurementsCounter++,this.changeCurrentMeasurement(i),this.currentMeasurement},a.createMeasurementFromData=function(e,t,i,s){var a=this;this.createMeasurement(t),i instanceof Function&&i(this.currentMeasurement),this.initPicks(e.picks),s instanceof Function&&s(),this.currentMeasurement.measurementType===n.MeasurementTypes.MEASUREMENT_AREA&&(this.currentMeasurement.closedArea=!0);this.currentMeasurement.indicator.changeAllEndpointsEditableStyle(!0),this.currentMeasurement.indicator.enableSelectionAreas(!0),this.currentMeasurement.indicator.enableLabelsTouchEvents(!0),this.activatePicks(),this.currentMeasurement.computeResult(this.currentMeasurement.picks,this.viewer),this.currentMeasurement.indicator.renderFromPoints(function(){for(var e=a.restoredMeasurementData[a.currentMeasurement.id],t=Object.keys(e),i=[],n=0;n<t.length;n++){var s=t[n],r=e[s];i[s]=r.intersection}return i}(),!0),this.currentMeasurement.indicator.changeAllEndpointsEditableStyle(!0),this.currentMeasurement.indicator.enableSelectionAreas(!0),this.currentMeasurement.indicator.enableLabelsTouchEvents(!0),this.currentMeasurement.isRestored=!0},a.initPicks=function(e){if(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];if(n){var s=i+1,a=new THREE.Vector3(n.intersection.x,n.intersection.y,n.intersection.z),r=n.hasOwnProperty("modelId")&&n.modelId?this.viewer.impl.findModel(n.modelId):this.viewer.model;if(r){var o=r.getData();a=o&&o.hasOwnProperty("globalOffset")?a.add(o.globalOffset).clone():a.clone()}t[s]={intersection:a,viewportId:n.viewportIndex2d,hasTopology:n.hasTopology,modelId:n.modelId,snapNode:n.snapNode},this.currentMeasurement.getPick(s)}}this.restoredMeasurementData[this.currentMeasurement.id]=t}},a.activatePicks=function(){if(this.currentMeasurement.picks)for(var e=Object.keys(this.currentMeasurement.picks),t=this.currentMeasurement.id,i=0;i<e.length;i++){var s=e[i],a=this.currentMeasurement.picks[s],r=this.getRestoredMeasurementData()[t][s],o=r.intersection.clone();!a.getGeometry()&&r.intersection&&(a.geomType=n.SnapType.SNAP_VERTEX,a.geomVertex=o,a.intersectPoint=o,a.modelId=r.modelId,a.snapNode=r.snapNode,a.viewportIndex2d=r.viewportId)}},a.changeCurrentMeasurement=function(e){this.currentMeasurement=e,this.viewer.dispatchEvent({type:n.Events.MEASUREMENT_CHANGED_EVENT,data:{type:e.measurementType,id:e.id}})},a.removeCurrentMeasurement=function(){Object.keys(this.measurementsList).length>0&&delete this.measurementsList[this.currentMeasurement.id]},a.init=function(){this.reset()},a.destroy=function(){this.reset()},a.reset=function(){this.currentMeasurement=null,this.measurementsList={},this.measurementsCounter=0};var r=Autodesk.Viewing,o=r.MeasureCommon,l=function(e,t,i){this.viewer=e,this.setGlobalManager(e.globalManager),this.measurement=t,this.tool=i,this.snapper=i.getSnapper(),this.materialExtensionLine=null,this.materialExtensionFace=null,this.extensionLines=[],this.extensionFaces=[],this.grayOutPlane=[],this.materialPoint=null,this.materialLine=null,this.materialAngle=null,this.materialAngleOutline=null,this.materialGreyOutPlane=null,this.materialFace=null,this.angleArc=null,this.angleOutline=[],this.showMeasureResult=!1,this.visibleLabels=[],this.overlayName="measure-indicator-overlay-"+(t.id||""),this.xAxis=this.viewer.autocam.getWorldRightVector(),this.yAxis=this.viewer.autocam.getWorldUpVector(),this.zAxis=this.viewer.autocam.getWorldFrontVector()},h=l.prototype;function c(e){function t(e,t,n,s){this.x=e,this.y=t,this.h=n,this.d=function(e,t,n){for(var s=!1,a=1/0,r=0;r<n.length;r++)for(var o=n[r],l=0,h=o.length,c=h-1;l<h;c=l++){var u=o[l],d=o[c];u.y>t!=d.y>t&&e<(d.x-u.x)*(t-u.y)/(d.y-u.y)+u.x&&(s=!s),a=Math.min(a,i(e,t,u,d))}return(s?1:-1)*Math.sqrt(a)}(e,t,s),this.max=this.d+this.h*Math.SQRT2}function i(e,t,i,n){var s=i.x,a=i.y,r=n.x-s,o=n.y-a;if(0!==r||0!==o){var l=((e-s)*r+(t-a)*o)/(r*r+o*o);l>1?(s=n.x,a=n.y):l>0&&(s+=r*l,a+=o*l)}return(r=e-s)*r+(o=t-a)*o}function n(e,t){if(!(this instanceof n))return new n(e,t);if(this.data=e||[],this.length=this.data.length,this.compare=t||function(e,t){return e<t?-1:e>t?1:0},this.length>0)for(var i=this.length>>1;i>=0;i--)this._down(i)}if(n.prototype={push:function(e){this.data.push(e),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var e=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),e}},peek:function(){return this.data[0]},_up:function(e){for(var t=this.data,i=this.compare,n=t[e];e>0;){var s=e-1>>1,a=t[s];if(i(n,a)>=0)break;t[e]=a,e=s}t[e]=n},_down:function(e){for(var t=this.data,i=this.compare,n=this.length>>1,s=t[e];e<n;){var a=1+(e<<1),r=a+1,o=t[a];if(r<this.length&&i(t[r],o)<0&&(a=r,o=t[r]),i(o,s)>=0)break;t[e]=o,e=a}t[e]=s}},3===e.length)return function(e){for(var t=new THREE.Vector3,i=e.length,n=0;n<i;n++)t.add(e[n]);return t.multiplyScalar(1/i),t}(e);var s,a,r,o;e=[e];for(var l=0;l<e[0].length;l++){var h=e[0][l];(!l||h.x<s)&&(s=h.x),(!l||h.y<a)&&(a=h.y),(!l||h.x>r)&&(r=h.x),(!l||h.y>o)&&(o=h.y)}var c=r-s,u=o-a,d=Math.min(c,u),p=d/2,m=new n(null,(function(e,t){return t.max-e.max}));if(0===d)return[s,a];for(var g=s;g<r;g+=d)for(var b=a;b<o;b+=d)m.push(new t(g+p,b+p,p,e));var v=function(e){for(var i=0,n=0,s=0,a=e[0],r=0,o=a.length,l=o-1;r<o;l=r++){var h=a[r],c=a[l],u=h.x*c.y-c.x*h.y;n+=(h.x+c.x)*u,s+=(h.y+c.y)*u,i+=3*u}return 0===i?new t(a[0].x,a[0].y,0,e):new t(n/i,s/i,0,e)}(e),f=new t(s+c/2,a+u/2,0,e);for(f.d>v.d&&(v=f);m.length;){var A=m.pop();A.d>v.d&&(v=A),A.max-v.d<=.01||(p=A.h/2,m.push(new t(A.x-p,A.y-p,p,e)),m.push(new t(A.x+p,A.y-p,p,e)),m.push(new t(A.x-p,A.y+p,p,e)),m.push(new t(A.x+p,A.y+p,p,e)))}return{x:v.x,y:v.y}}r.GlobalManagerMixin.call(h),h.init=function(){return!1},h.updateDistance=function(){return!1},h.updateAngle=function(){return!1},h.clear=function(){return!1},h.updateLabelsPosition=function(){return!1},h.renderFromPoints=function(e,t){this.showMeasureResult=t,this.clear();for(var i=1;i<=Object.keys(e).length;i++){var n=e[i];this.endpoints[i]||this.createEndpoint(i),this.endpoints[i].position=new THREE.Vector3(n.x,n.y,n.z),this.showClick(i)}this.renderRubberbandFromPoints(e),this.updateLabelsPosition()},h.render=function(e,t){this.showMeasureResult=t,this.clear();for(var i=1;i<=Object.keys(e).length;i++)this.measurement.hasPick(i)&&this.renderPick(i);this.renderRubberband(e),this.updateLabelsPosition()},h.changeEndpointOnEditStyle=function(e,t){return!1},h.handleResize=function(){return!1},h.setNoTopology=function(){return!1},h.setFetchingTopology=function(){return!1},h.setTopologyAvailable=function(){return!1},h.clientToCanvasCoords=function(e){var t=this.viewer.impl.getCanvasBoundingClientRect(),i={};return e.hasOwnProperty("center")?(e.canvasX=i.x=e.center.x-t.left,e.canvasY=i.y=e.center.y-t.top):(e.canvasX=i.x=e.pointers[0].clientX-t.left,e.canvasY=i.y=e.pointers[0].clientY-t.top),i},h.initLabelMobileGestures=function(e,t){var i=this.viewer.toolController.getTool("magnifyingGlass");this.hammer=new r.Hammer.Manager(e,{recognizers:[r.GestureRecognizers.drag,r.GestureRecognizers.singletap],handlePointerEventMouse:!1,inputClass:r.isIE11?r.Hammer.PointerEventInput:r.Hammer.TouchInput}),this.onSingleTapBinded=function(e){var i=this.clientToCanvasCoords(e);this.snapper.onMouseDown(i),this.tool.editEndpoint(e,t,this.measurement.id)}.bind(this),this.onDragStartBinded=function(e){var n=this.clientToCanvasCoords(e);this.snapper.onMouseDown(n),this.tool.editEndpoint(e,t,this.measurement.id),this.tool.editByDrag=!0,e.type="press",i.handlePressHold(e),this.tool.handlePressHold(e),e.type="dragstart",i.handleGesture(e),this.tool.handleGesture(e)}.bind(this),this.onDragMoveBinded=function(e){var t=this.clientToCanvasCoords(e);this.snapper.onMouseDown(t),i.handleGesture(e),this.tool.handleGesture(e)}.bind(this),this.onDragEndBinded=function(e){var t=this.clientToCanvasCoords(e);this.snapper.onMouseDown(t),i.handleGesture(e),this.tool.handleGesture(e),e.type="pressup",i.handlePressHold(e),this.tool.handlePressHold(e),this.tool.handleButtonUp(e)}.bind(this),this.hammer.on("singletap",this.onSingleTapBinded),this.hammer.on("dragstart",this.onDragStartBinded),this.hammer.on("dragmove",this.onDragMoveBinded),this.hammer.on("dragend",this.onDragEndBinded)},h.clearLabelMobileGestures=function(){this.hammer&&(this.hammer.off("singletap",this.onSingleTapBinded),this.hammer.off("dragstart",this.onDragStartBinded),this.hammer.off("dragmove",this.onDragMoveBinded),this.hammer.off("dragend",this.onDragEndBinded),this.hammer=null)},h.updateVisibleLabelsArray=function(e,t){if(t)this.visibleLabels.indexOf(e)>-1||this.visibleLabels.push(e);else{var i=this.visibleLabels.indexOf(e);i>-1&&this.visibleLabels.splice(i,1)}},h.hideEndpoints=function(){for(var e in this.endpoints)if(this.endpoints.hasOwnProperty(e)){var t=this.endpoints[e];t.label&&this.hideLabel(t.label)}},h.showEndpoints=function(){for(var e in this.endpoints)if(this.endpoints.hasOwnProperty(e)){var t=this.endpoints[e];this.measurement.hasPick(e)&&t.label&&this.showLabel(t.label)}},h.hideLabel=function(e){e&&(o.safeToggle(e,"visible",!1),this.updateVisibleLabelsArray(e,!1))},h.showLabel=function(e){e&&(o.safeToggle(e,"visible",!0),this.updateVisibleLabelsArray(e,!0))},h.changeEndpointOnEditStyle=function(e,t){this.endpoints[e]&&this.endpoints[e].label&&o.safeToggle(this.endpoints[e].label,"on-edit",t)},h.changeEndpointEditableStyle=function(e,t){this.endpoints[e]&&this.endpoints[e].label&&o.safeToggle(this.endpoints[e].label,"editable",t)},h.changeAllEndpointsEditableStyle=function(e){for(var t in this.endpoints)this.endpoints.hasOwnProperty(t)&&this.changeEndpointEditableStyle(t,e)},h.changeAllEndpointsOnEditStyle=function(e){for(var t in this.endpoints)this.endpoints.hasOwnProperty(t)&&this.changeEndpointOnEditStyle(t,e)},h.hideLabelsOutsideOfView=function(){this.viewer.model&&!this.viewer.model.is2d()&&this.visibleLabels.forEach(function(e){if(e.point){var t=this.viewer.navigation.isPointVisible(e.point);(e.classList.contains("visible")&&!t||!e.classList.contains("visible")&&t)&&e.classList.toggle("visible",t)}}.bind(this))},h.showClick=function(e){this.tool.getActivePointIndex()!==e&&this.showLabel(this.endpoints[e].label)},h.hideClick=function(e){this.endpoints[e]&&this.hideLabel(this.endpoints[e].label)},h.renderPick=function(e){this.endpoints[e]||this.createEndpoint(e),this.renderEndpointGeometry(e),this.showClick(e)},h.renderEndpointGeometry=function(e){var t=o.getSnapResultPosition(this.measurement.getPick(e),this.viewer);null!==t&&(this.endpoints[e].position=t.clone())},h.drawEdgeAsCylinder=function(e,t,i,n,s){var a,r=[];if(1==n)for(var o=0;o<e.vertices.length;o+=2)a=this.cylinderMesh(e.vertices[o],e.vertices[o+1],t,i,s),this.setCylinderScale(a,e.vertices[o],e.vertices[o+1]),r.push(a);else for(o=0;o<e.vertices.length-1;o++)a=this.cylinderMesh(e.vertices[o],e.vertices[o+1],t,i,s),this.setCylinderScale(a,e.vertices[o],e.vertices[o+1]),r.push(a);return r},h.drawDashedLine=function(e,t,i,n,s,a,r){for(var o=new THREE.Geometry,l=(new THREE.Vector3).subVectors(t,e),h=l.length()-n,c=l.normalize(),u=0,d=e.clone(),p=0;p<h;){var m=this.viewer.navigation.isPointVisible(d);m&&(o.vertices[u]=d.clone(),u++),d.addVectors(d,c.clone().multiplyScalar(i)),m&&(o.vertices[u]=d.clone(),u++),d.addVectors(d,c.clone().multiplyScalar(n)),p+=i+n}return l=this.drawEdgeAsCylinder(o,s,a,1,this.getNewCylinderGeometry()),this.viewer.impl.addMultipleOverlays(r,l),l},h.drawLineAsCylinder=function(e,t,i,n){var s;return 2==e.vertices.length&&(s=this.cylinderMesh(e.vertices[0],e.vertices[1],t,i,this.getNewCylinderGeometry()),this.setCylinderScale(s,e.vertices[0],e.vertices[1]),this.viewer.impl.addOverlay(n,s)),s},h.getNewCylinderGeometry=function(){return new THREE.CylinderGeometry(.1,.1,1,8,1,!0)},h.cylinderMesh=function(e,t,i,n,s){var a=(new THREE.Vector3).subVectors(t,e),r=new THREE.Matrix4;r.lookAt(e,t,(new THREE.Object3D).up),r.multiply((new THREE.Matrix4).set(n,0,0,0,0,0,n,0,0,-a.length(),0,0,0,0,0,1));var o=new THREE.Mesh(s,i);return o.applyMatrix(r),o.lmv_line_width=n,o.position.x=(t.x+e.x)/2,o.position.y=(t.y+e.y)/2,o.position.z=(t.z+e.z)/2,o},h.setCylinderScale=function(e,t,i){var n;if(t&&i){var s=o.nearestPointInPointToSegment(this.viewer.navigation.getPosition(),t,i);n=this.setScale(s)}else n=this.setScale(e.position);e.hasOwnProperty("lmv_line_width")&&(n*=e.lmv_line_width),e.scale.x=n,e.scale.z=n},h.setScale=function(e){var t=this.viewer.navigation,i=t.getCamera(),n=t.getPosition(),s=e.clone(),a=i.isPerspective?s.sub(n).length():t.getEyeVector().length(),r=t.getVerticalFov();return 5*(2*a*Math.tan(THREE.Math.degToRad(.5*r)))/t.getScreenViewport().height},h.alignLabelWithLine=function(e,t,i,n,s){var a=s.navigation.getCameraUpVector(),r=180*new THREE.Vector3(0,1,0).angleTo(a)/Math.PI;r=a.x>=0?r:-r;var o=null,l=t.x-i.x,h=t.y-i.y;o=-((o=t.x<i.x?180*Math.atan2(-h,-l)/Math.PI:180*Math.atan2(h,l)/Math.PI)+r),Math.abs(o)>90&&(o+=180),e.style.transform="rotate("+o+"deg) translate(0px, "+n+"px)"},h.destroy=function(){for(var e in this.materialPoint=null,this.materialFace=null,this.materialLine=null,this.materialAngle=null,r.isTouchDevice()&&this.clearLabelMobileGestures(),this.endpoints)if(this.endpoints.hasOwnProperty(e)){var t=this.endpoints[e];t.label&&(t.label.removeEventListener(r.isSafari()?"mousedown":"pointerdown",this.onMouseClickBinded),t.label.removeEventListener("mousewheel",this.viewer.toolController.mousewheel),t.label.parentNode.removeChild(t.label),t.label=null)}this.visibleLabels=[]},h.renderRubberbandFromPoints=function(e){switch(this.measurement.measurementType){case o.MeasurementTypes.MEASUREMENT_DISTANCE:var t=e[1],i=e[2];t&&i&&this.renderDistanceMeasurementFromPoints(t,i);break;case o.MeasurementTypes.MEASUREMENT_ANGLE:this.renderAngleMeasurementFromPoints(e);break;case o.MeasurementTypes.MEASUREMENT_AREA:this.renderAreaMeasurementFromPoints(e)}},h.renderRubberband=function(e){switch(this.measurement.measurementType){case o.MeasurementTypes.MEASUREMENT_DISTANCE:var t=e[1],i=e[2],n=o.getSnapResultPosition(t,this.viewer),s=o.getSnapResultPosition(i,this.viewer);n&&s&&this.renderDistanceMeasurement(n,s);break;case o.MeasurementTypes.MEASUREMENT_ANGLE:this.renderAngleMeasurement(e);break;case o.MeasurementTypes.MEASUREMENT_AREA:this.renderAreaMeasurement(e)}},h.initMouseEvent=function(e,t){var i=r.isSafari();this.onMouseClickBinded=function(e){(i||"mouse"===e.pointerType)&&(e.canvasX=e.clientX,e.canvasY=e.clientY,this.tool.editEndpoint(e,t,this.measurement.id))}.bind(this),e.addEventListener(i?"mousedown":"pointerdown",this.onMouseClickBinded)};var u=Autodesk.Viewing,d=Autodesk.Viewing.MeasureCommon;function p(e,t,i){l.call(this,e,t,i),this.measureTool=i,this.endpoints=[],this.lines={xyz:{axis:!1,material:g("005BCE"),className:"adsk-icon-axis-delta-xyz measure-label-axis-delta measure-label-axis-xyz"},x:{axis:!0,material:g("F12C2C"),className:"adsk-icon-axis-delta-x measure-label-axis-delta measure-label-axis-x",iconText:"X"},y:{axis:!0,material:g("0BB80B"),className:"adsk-icon-axis-delta-y measure-label-axis-delta measure-label-axis-y",iconText:"Y"},z:{axis:!0,material:g("2C2CF1"),className:"adsk-icon-axis-delta-z measure-label-axis-delta measure-label-axis-z",iconText:"Z"}},this.segments=[],this.dashedLine={},this.simple=!1,this.angleLabel={},this.areaLabel={},this.labels=[],this.isLeaflet=!1,this.topologyStatus=b,this.tmpVector=new THREE.Vector3,this.surfaceColor=new THREE.MeshBasicMaterial({color:parseInt("005BCE",16),opacity:.15,transparent:!0,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide})}p.prototype=Object.create(l.prototype),p.prototype.constructor=p;var m=p.prototype;function g(e){return new THREE.MeshBasicMaterial({color:parseInt(e,16),depthTest:!1,depthWrite:!1,side:THREE.DoubleSide})}var b=0;function v(e){return e.classList.contains("visible")}function f(e,t){return e.right>=t.left&&e.right<=t.right}function A(e,t){return e.left>=t.left&&e.left<=t.right}function y(e,t){return e.left<=t.left&&e.right>=t.right}function w(e,t,i){e.style.left=parseInt(e.style.left,10)+(i.right-t.left)+"px"}function E(e,t,i){e.style.top=parseInt(e.style.top,10)+(i.bottom-t.top)+"px"}function x(e,t){if(e){var i=e.querySelector(".measure-length-text");i&&(i.textContent=t)}}function M(e,t){if(e){var i=e.querySelector(".measure-delta-text");i&&(i.textContent=t)}}function T(e,t,i){if(e){var n=e.querySelector(".measure-fetching-topology");n&&(n.style.display=t&&1===i?"inline-block":"none")}}function k(e,t,i,n){var a=e,r=["measure"];this.setGlobalManager(e.globalManager);var o=i,l=Autodesk.Viewing,h=(Autodesk.Viewing.Extensions.Measure,Autodesk.Viewing.MeasureCommon),c=!1,u=!1,d=!1,m=0,g=!1,b=!1,v=null,f=null,A=!1,y=new s(a),w=null,E=null,x=n,M=!1,T=[],k=null,C=null,L=h.MeasurementTypes.MEASUREMENT_DISTANCE,S=null;function R(){return w?0===m?null:(e=m===w.getMaxNumberOfPicks()+1?w.countPicks():m,w.getPick(e)):null;var e}function P(){return w?0===m?null:(e=1===m?w.countPicks():m===w.getMaxNumberOfPicks()+1?w.countPicks()-1:m-1,w.getPick(e)):null;var e}function B(){m=0}function N(){m=w.countPicks()+1,G(!0),w.indicator.enableSelectionAreas(!0)}function V(){return 0===m||!w}function D(e){for(var t=(e=e||w).clonePicks(),i=[],n=0;n<t.length;n++){var s=t[n],r=h.getSnapResultPosition(s,a),o=s.hasOwnProperty("modelId")&&s.modelId?a.impl.findModel(s.modelId):a.model;if(o){var l=o.getData();r=l&&l.hasOwnProperty("globalOffset")?r.clone().sub(l.globalOffset):r.clone()}var c={intersection:JSON.parse(JSON.stringify(r)),modelId:s.modelId,viewportIndex2d:s.viewportIndex2d,snapNode:s.snapNode};i.push(c)}return i}function I(t,i){if(w.hasPick(1)&&m>3&&!w.closedArea){var n=w.getPick(1),s=h.getSnapResultPosition(n,a),r=h.project(s,e),o=h.getSnapResultPosition(t,a),l=h.project(o,e);(i||l.distanceTo(r)<25)&&(x.onMouseMove(r),n.copyTo(t))}}function O(e){var t=w.computeResult(w.picks,a,x);return w.indicator.render(w.picks,g||!!e),t}function z(e){e=e||w;var t=h.MeasurementTypes;switch(e.measurementType){case t.MEASUREMENT_DISTANCE:return"Distance";case t.MEASUREMENT_ANGLE:return"Angle";case t.MEASUREMENT_AREA:return"Area";case t.CALIBRATION:return"Calibration";default:return}}function G(e){for(var t in y.measurementsList)if(y.measurementsList.hasOwnProperty(t)){var i=y.measurementsList[t];i.indicator.changeAllEndpointsEditableStyle(e),i.indicator.enableSelectionAreas(e),i.indicator.enableLabelsTouchEvents(e)}}this.areAllPicksSet=function(){return w&&m===w.getMaxNumberOfPicks()+1},this.setSessionMeasurements=function(e){S=JSON.parse(JSON.stringify(e))},this.getSessionMeasurements=function(){return JSON.parse(JSON.stringify(S))},this.register=function(){},this.deregister=function(){this.deactivate()},this.isActive=function(){return c},this.getNames=function(){return r},this.getName=function(){return r[0]},this.getPriority=function(){return 50},this.getCursor=function(){return u?null:"url(data:image/png;base64,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), auto"},this.getCurrentMeasurementRaw=function(){return w},this.getActivePointIndex=function(){return m},this.getMeasurementsManager=function(){return y},this.startNewMeasurement=function(){(w=y.createMeasurement(L)).attachIndicator(a,this,p),E instanceof Function&&(E(),E=null),G(!1)},this.changeMeasurementType=function(e){L=e},this.activate=function(){if(c=!0,y.init(),B(),u=!1,this.isEditingEndpoint=!1,this.editByDrag=!1,a.impl.pauseHighlight(!0),a.clearSelection(),C=a.getState({objectSet:!0}),a.toolController.activateTool("snapper"),a.toolController.activateTool("magnifyingGlass"),this.onMeasurementChangedBinded=this.onMeasurementChanged.bind(this),a.addEventListener(h.Events.MEASUREMENT_CHANGED_EVENT,this.onMeasurementChangedBinded),a.addEventListener(l.CAMERA_CHANGE_EVENT,this.onCameraChange),a.addEventListener(l.SHOW_ALL_EVENT,this.onShowAllEvent),a.prefs.get(l.Private.Prefs.RESTORE_SESSION_MEASUREMENTS)){var e=this.getSessionMeasurements();this.setMeasurements(e),this.isolateMeasurement()}},this.deactivate=function(){if(c){if(a.prefs.get(l.Private.Prefs.RESTORE_SESSION_MEASUREMENTS)){this.clearIncompleteMeasurement();var e=this.getMeasurementList();this.setSessionMeasurements(e)}for(c=!1,this.clearIsolate(),C=null;Object.keys(y.measurementsList).length>0;)w=y.measurementsList[Object.keys(y.measurementsList)[0]],y.changeCurrentMeasurement(w),this.clearCurrentMeasurement(),w=null;x&&x.isActive()&&a.toolController.deactivateTool("snapper"),a.toolController.deactivateTool("magnifyingGlass"),a.impl.pauseHighlight(!1),y.destroy(),a.removeEventListener(l.CAMERA_CHANGE_EVENT,this.onCameraChange),a.removeEventListener(h.Events.MEASUREMENT_CHANGED_EVENT,this.onMeasurementChangedBinded),a.removeEventListener(l.SHOW_ALL_EVENT,this.onShowAllEvent)}},this.clearIncompleteMeasurement=function(){this.areAllPicksSet()||(this.isEditingEndpoint?this.undoEditEndpoint():this.clearCurrentMeasurement())},this.update=function(){return!1},this.getUnits=function(){return o.units},this.setUnits=function(e){if(o.units!==e)for(var t in o.units=e,a.dispatchEvent({type:h.Events.DISPLAY_UNITS_CHANGED,units:e}),y.measurementsList)if(y.measurementsList.hasOwnProperty(t)){var i=y.measurementsList[t];i.indicator&&i.indicator.updateResults()}},this.getPrecision=function(){return o.precision},this.setPrecision=function(e){if(o.precision!==e)for(var t in o.precision=e,y.measurementsList)if(y.measurementsList.hasOwnProperty(t)){var i=y.measurementsList[t];i.indicator&&i.indicator.updateResults()}},this.getDistanceXYZ=function(e){return e||(e=w),this.getDistanceAux(e.distanceXYZ)},this.getDistanceX=function(e){return e||(e=w),this.getDistanceAux(e.distanceX)},this.getDistanceY=function(e){return e||(e=w),this.getDistanceAux(e.distanceY)},this.getDistanceZ=function(e){return e||(e=w),this.getDistanceAux(e.distanceZ)},this.getDistanceAux=function(e){if(a.model){var t=Autodesk.Viewing.Private.convertUnits(a.model.getUnitString(),o.units,o.calibrationFactor,e||0);return Autodesk.Viewing.Private.formatValueWithUnits(t,o.units,3,o.precision)}},this.getAngle=function(e){e||(e=w);var t=e.angle;return Autodesk.Viewing.Private.formatValueWithUnits(t,String.fromCharCode(176),3,o.precision)},this.getArea=function(t){if(a.model){t||(t=w);var i=Autodesk.Viewing.Private.convertUnits(e.model.getUnitString(),o.units,o.calibrationFactor,t.area,"square");return o.units?Autodesk.Viewing.Private.formatValueWithUnits(i,o.units+"^2",3,o.precision):Autodesk.Viewing.Private.formatValueWithUnits(i,null,3,o.precision)}},this.setMeasurements=function(e){var t=this;if(e&&0!==(e=Array.isArray(e)?e:[e]).length){for(var i=0;i<e.length;i++){var n=e[i],s=r(n);if(s){y.createMeasurementFromData(n,s,(function(e){w=e,e.attachIndicator(a,t,p),E instanceof Function&&(E(),E=null),G(!1)}),(function(){var e=y.getRestoredMeasurementData()[w.id];m=e.length}))}}this.deselectAllMeasurements()}function r(e){var t;switch(e.type){case"Distance":t=h.MeasurementTypes.MEASUREMENT_DISTANCE;break;case"Angle":t=h.MeasurementTypes.MEASUREMENT_ANGLE;break;case"Area":t=h.MeasurementTypes.MEASUREMENT_AREA;break;default:return}return t}},this.getMeasurement=function(e,t){o.units=e||o.units,o.precision=t||o.precision;var i=["Vertex","Edge","Face","Circular Arc","Curved Edge","Curved Face"],n=D(),s=z();return{from:i[w.getGeometry(1).type],to:i[w.getGeometry(2).type],distance:this.getDistanceXYZ(),deltaX:this.getDistanceX(),deltaY:this.getDistanceY(),deltaZ:this.getDistanceZ(),angle:this.getAngle(),area:this.getArea(),unitType:o.units,precision:o.precision,picks:n,type:s}},this.getMeasurementPoints=function(){return w.clonePicks()},this.getMeasurementList=function(e,t){for(var i=[],n=null,s=["Vertex","Edge","Face","Circular Arc","Curved Edge","Curved Face"],a=Object.keys(y.measurementsList),r=0;r<a.length;r++){var l=D(n=y.measurementsList[a[r]]),h=z(n),c={from:s[n.getGeometry(1).type],to:s[n.getGeometry(2).type],distance:this.getDistanceXYZ(n),deltaX:this.getDistanceX(n),deltaY:this.getDistanceY(n),deltaZ:this.getDistanceZ(n),angle:this.getAngle(n),area:this.getArea(n),unitType:e||o.units,precision:t||o.precision,picks:l,type:h};i.push(c)}return i},this.clearCurrentMeasurement=function(){if(w){for(var e in B(),w.picks)w.picks.hasOwnProperty(e)&&this.clearPick(e);this.updateViewportId(!0),A&&this.clearIsolate(),w.indicator.clear(),w.indicator.destroy(),w=y.removeCurrentMeasurement(),w=null}G(!0)},this.clearPick=function(e){w&&w.hasPick(e)&&(w.clearPick(e),w.indicator.hideClick(e))},this.setIsolateMeasure=function(e){A=e},this.isolateMeasurement=function(){if(c&&A){var e=a.model.id,t={};for(var i in y.measurementsList)if(y.measurementsList.hasOwnProperty(i)){var n=y.measurementsList[i];for(var i in n.picks)if(n.picks.hasOwnProperty(i)){var s=n.getPick(i),r=s.modelId||e;Array.isArray(t[r])||(t[r]=[]),-1==t[r].indexOf(s.snapNode)&&t[r].push(s.snapNode)}}var o=[];for(var r in t)if(t.hasOwnProperty(r)){var l=a.impl.findModel(parseInt(r));o.push({model:l,ids:t[r]})}o.length&&a.impl.visibilityManager.aggregateIsolate(o)}},this.clearIsolate=function(){C&&a.restoreState(C,void 0,!0)},this.onShowAllEvent=function(e){C=null},this.deselectAllMeasurements=function(){for(var e in w&&!this.areAllPicksSet()&&(this.isEditingEndpoint?this.undoEditEndpoint():this.clearCurrentMeasurement()),y.measurementsList)if(y.measurementsList.hasOwnProperty(e)){var t=y.measurementsList[e];t.indicator&&(t.indicator.setSimple(!0),t.indicator.hideEndpoints(),t.indicator.unfocusLabels())}w=null},this.onMeasurementChanged=function(){this.deselectAllMeasurements(),(w=y.getCurrentMeasurement()).isComplete()&&(w.indicator.setSimple(!1),N(),O(!0),this.updateResults())},this.selectMeasurementById=function(e){w||(w=y.selectMeasurementById(e)),w.id!==e&&(this.clearIncompleteMeasurement(),w=y.selectMeasurementById(e))},this.editEndpoint=function(e,t,i){if(w.id===i&&m===t)return w.indicator.changeEndpointOnEditStyle(t,!1),void this.undoEditEndpoint();for(var n in this.selectMeasurementById(i),m=t,this.isEditingEndpoint=!0,w.indicator.changeEndpointOnEditStyle(t,!0),G(!1),w.picks)w.picks.hasOwnProperty(n)&&(T[n]=w.getPick(n).clone());if(this.updateViewportId(),A&&this.clearIsolate(),w.isRestored){x.onMouseMove({x:e.canvasX,y:e.canvasY});var s=x.getSnapResult().clone(),a=w.getPick(m);s.copyTo(a),a.isValid=!0,w.isRestored=!function(){var e=w.picks;for(var t in e){if(e.hasOwnProperty(t))if(!e[t].isValid)return!1}return!0}()}l.isMobileDevice()||this._handleMouseEvent(e)},this.undoEditEndpoint=function(){for(var e in w.indicator.clear(),w.picks)w.picks.hasOwnProperty(e)&&w.setPick(e,T[e].clone());w.indicator.changeEndpointOnEditStyle(m,!1),this.isEditingEndpoint=!1,this.updateViewportId(!0),N(),O(!0)},this.updateResults=function(){w.indicator.updateResults(),w.indicator.showEndpoints(),w.indicator.focusLabels(),w.isComplete()&&this.isolateMeasurement()},this.deleteMeasurements=function(){for(var e=y.measurementsList,t=Object.keys(e),i=0;i<t.length;i++){var n=t[i];y.currentMeasurement=e[n],w=y.getCurrentMeasurement(),this.deleteCurrentMeasurement()}},this.deleteCurrentMeasurement=function(){this.clearCurrentMeasurement(),this.isEditingEndpoint=!1,this.editByDrag=!1,u=!1,this.isolateMeasurement()},this.deleteCurrentPick=function(){for(var e=R().id;w.hasPick(e+1);)w.setPick(e,w.getPick(e+1)),e++;delete w.picks[e];var t=w.countPicks();if(--m<=0&&(m=t),this.isEditingEndpoint){if(2==t)return void this.deleteCurrentMeasurement();w.indicator.changeAllEndpointsOnEditStyle(!1),this.isEditingEndpoint=!1,this.updateViewportId(!0),N(),O()}else this._handleMouseEvent()},this.updateViewportId=function(e){if(a.model&&a.model.is2d())if(e||V())a.impl.updateViewportId(0),x.setViewportId(null);else if(!M){var t=P().viewportIndex2d||R().viewportIndex2d;a.impl.updateViewportId(t),x&&x.setViewportId(t)}},this.setNoTopology=function(){w&&w.indicator?w.indicator.setNoTopology():E=function(){w.indicator.setNoTopology()}},this.setFetchingTopology=function(){w&&w.indicator?w.indicator.setFetchingTopology():E=function(){w.indicator.setFetchingTopology()}},this.setTopologyAvailable=function(){w&&w.indicator?w.indicator.setTopologyAvailable():E=function(){w.indicator.setTopologyAvailable()}},this.getSnapper=function(){return x},this.correctPickPosition=function(){var t,i=R();if(i&&!i.getGeometry()&&k&&(i.geomType=h.SnapType.SNAP_VERTEX,i.geomVertex=k,i.intersectPoint=k),!!w&&0!==m&&(t=1===m?w.countPicks():m===w.getMaxNumberOfPicks()+1?w.countPicks()-1:m-1,w.hasPick(t))){var n=P();if(!h.correctPerpendicularPicks(n,i,e,x)){var s=(i.id+1)%(w.countPicks()+1);if(0===s&&(s=1),s!==i.id&&w.hasPick(s)){var a=w.getPick(s);h.correctPerpendicularPicks(a,i,e,x)}}w.measurementType==h.MeasurementTypes.MEASUREMENT_AREA&&I(i)}},this._handleMouseEvent=function(e){var t=!1;if(x.isSnapped())(this.areAllPicksSet()||V())&&(this.startNewMeasurement(),m=1),x.copyResults(R()),t=!0;else{if(e&&a.model&&a.model.is2d()){var i=a.container.getBoundingClientRect(),n=e.canvasX||e.clientX-i.left,s=e.canvasY||e.clientY-i.top;n&&s&&(k=h.inverseProject({x:n,y:s},a))}if(g&&w&&!this.isEditingEndpoint&&m===w.getMaxNumberOfPicks()+1)return!0;var r=R();r&&r.clear()}if(w&&(this.correctPickPosition(),g&&this._doConsumeSingleClick(),!V())){var o=O();w.hasPick(2)&&(t&=o)}return t},this._doConsumeSingleClick=function(){if(w.measurementType===h.MeasurementTypes.MEASUREMENT_AREA&&!w.closedArea){var e=w.countPicks(),t=w.getPick(1),i=w.getPick(e);e>=3&&w.hasEqualPicks(t,i)&&(i.clear(),delete w.picks[e],w.closedArea=!0)}this.updateResults();var n=w.isComplete();this.updateViewportId(n)},this.handleButtonDown=function(e,t){return l.isMobileDevice()||(u=!0,0!==t||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||(g=!0,v=e.canvasX,f=e.canvasY)),!1},this.handleMouseMove=function(e){return l.isMobileDevice()||(e.canvasX===v&&e.canvasY===f||(g=!1),d=this.isEditingEndpoint,V()||this.areAllPicksSet()||(this.clearPick(m),this._handleMouseEvent(e)),x.indicator.render()),!1},this.restoreMouseListeners=function(){a.toolController.getTool("gestures").controller.enableMouseButtons(!0)},this.handlePressHold=function(e){if(g=!1,l.isTouchDevice())switch(e.type){case"press":return M=!0,(this.areAllPicksSet()||V())&&(this.startNewMeasurement(),A&&this.clearIsolate(),m=1),this._handleMouseEvent(e),x.indicator.render(),!0;case"pressup":return g=!0,this.restoreMouseListeners(),b=!b,this.handleSingleClick(e),M=!1,!0}return!1},this.handleGesture=function(e){if(l.isTouchDevice()){if(g=!1,M)switch(this.clearPick(m),e.type){case"dragstart":case"dragmove":return this._handleMouseEvent(e),x.indicator.render(),!0;case"dragend":return M=!1,g=!0,this.editByDrag||(b=!b,this.handleSingleClick(e)),this.editByDrag=!1,this.restoreMouseListeners(),!0;case"pinchstart":case"pinchmove":this._handleMouseEvent(e),x.indicator.render();break;case"pinchend":return g=!0,b=!b,this.handleSingleClick(e),this.restoreMouseListeners(),!0}if(-1!==e.type.indexOf("pinch"))for(var t in y.measurementsList){if(y.measurementsList.hasOwnProperty(t))y.measurementsList[t].indicator.updateScale()}}return!1},this.handleButtonUp=function(e,t){return u=!1,v=null,f=null,d&&(g=!0,b=!b,this.handleSingleClick(e),d=!1),!1},this.handleSingleClick=function(e,t){return g&&(x.indicator.clearOverlays(),w&&w.indicator.changeEndpointOnEditStyle(m,!1),this._handleMouseEvent(e)?(this.updateResults(),m++):this.isEditingEndpoint?this.undoEditEndpoint():w&&w.measurementType===h.MeasurementTypes.MEASUREMENT_AREA&&w.countPicks()>3?(I(R(),!0),this._handleMouseEvent()):this.clearCurrentMeasurement(),w&&w.isComplete()&&N(),g=!1,b=!b,this.isEditingEndpoint=!1,x.clearSnapped()),!0},this.handleDoubleClick=function(e){return!0},this.onCameraChange=function(){for(var e in y.measurementsList){if(y.measurementsList.hasOwnProperty(e))y.measurementsList[e].indicator.updateScale()}x.indicator.onCameraChange()},this.handleSingleTap=function(e){return b||(g=!0,x.onMouseDown({x:e.canvasX,y:e.canvasY}),this.handleSingleClick(e)),b=!b,!0},this.handleDoubleTap=function(t){if(w&&w.measurementType===h.MeasurementTypes.MEASUREMENT_AREA&&w.countPicks()>2){var i=w.getPick(1),n=h.getSnapResultPosition(i,a),s=h.project(n,e);t.canvasX=s.x,t.canvasY=s.y,g=!0,x.onMouseDown(s),this.handleSingleClick(t),b=!b}return!0},this.handleResize=function(){for(var e in y.measurementsList)if(y.measurementsList.hasOwnProperty(e)){var t=y.measurementsList[e];t.indicator&&t.indicator.handleResize()}},this.handleKeyDown=function(e,t){switch(t){case Autodesk.Viewing.KeyCode.BACKSPACE:case Autodesk.Viewing.KeyCode.DELETE:return w&&w.measurementType===h.MeasurementTypes.MEASUREMENT_AREA&&!this.areAllPicksSet()&&w.countPicks()>2?this.deleteCurrentPick():this.deleteCurrentMeasurement(),!0}return!1}}m.init=function(){var e;switch(this.isLeaflet=this.viewer.model.getData().isLeaflet,this.onSelectionAreaClickedBinded=this.onSelectionAreaClicked.bind(this),this.lines.xyz.label||((e=this.lines.xyz.label=this.createMeasurementLabel()).addEventListener("mousewheel",this.viewer.toolController.mousewheel),e.addEventListener("click",this.onSelectionAreaClickedBinded),this.viewer.container.appendChild(e)),this.topologyStatus){case 1:this.setFetchingTopology();break;case 2:this.setTopologyAvailable();break;case b:this.setNoTopology()}this.showMeasureResult=!1,this.onCameraChangeBinded=this.onCameraChange.bind(this),this.viewer.addEventListener(u.CAMERA_CHANGE_EVENT,this.onCameraChangeBinded),this.handleButtonUpBinded=this.measureTool.handleButtonUp.bind(this.measureTool),this.addWindowEventListener("mouseup",this.handleButtonUpBinded)},m.createEndpoint=function(e){this.endpoints[e]={};var t=this.endpoints[e].label=this.createSnapResultLabel(e);this.viewer.container.appendChild(t)},m.updateLabelsPosition=function(){var e,t,i,n;for(n in this.endpoints)this.endpoints.hasOwnProperty(n)&&(i=this.endpoints[n].label,e=this.endpoints[n].position,i&&e&&v(i)&&((t=d.project(e,this.viewer)).x=t.x-i.getBoundingClientRect().width/2,t.y=t.y-i.getBoundingClientRect().height/2,i.style.top=t.y+"px",i.style.left=t.x+"px",i.point=e,this.labels.push(i)));for(var s in this.lines)if(this.lines.hasOwnProperty(s)){var a=this.lines[s];if((i=a.label)&&a.p1&&a.p2&&v(i)){if(a.line.visible=a.visible,e={x:(a.p1.x+a.p2.x)/2,y:(a.p1.y+a.p2.y)/2,z:(a.p1.z+a.p2.z)/2},t=d.project(e,this.viewer),i.style.top=t.y-Math.floor(i.clientHeight/2)+"px",i.style.left=t.x-Math.floor(i.clientWidth/2)+"px",this.viewer.model&&this.viewer.model.is2d()){var r=a===this.lines.xyz?0:i.clientHeight,o=d.project(a.p1,this.viewer),l=d.project(a.p2,this.viewer);if(i.clientWidth>=o.distanceTo(l)-this.endpoints[1].label.clientWidth){if(a!==this.lines.xyz){for(s in this.lines.x.line.visible=!1,this.lines.y.line.visible=!1,this.viewer.impl.invalidate(!1,!1,!0),this.lines)if(this.lines.hasOwnProperty(s)&&this.lines[s]!==this.lines.xyz){var h=this.lines[s].label;h&&(h.style.opacity=0)}break}r=i.clientHeight}if(a!==this.lines.xyz){var c=new THREE.Vector3,u=new THREE.Vector3;c.subVectors(this.lines.xyz.p1,this.lines.xyz.p2).normalize(),u.subVectors(a.p1,a.p2).normalize(),c.cross(this.viewer.navigation.getEyeVector()).normalize().dot(u)<0&&(r=-r)}this.alignLabelWithLine(i,a.p1,a.p2,r,this.viewer)}i.style.opacity=1,i.point=e,this.labels.push(i)}}if(this.angleLabel&&(i=this.angleLabel.label)&&this.angleLabel.p1&&this.angleLabel.p2&&v(i)&&(e={x:(this.angleLabel.p1.x+this.angleLabel.p2.x)/2,y:(this.angleLabel.p1.y+this.angleLabel.p2.y)/2,z:(this.angleLabel.p1.z+this.angleLabel.p2.z)/2},t=d.project(e,this.viewer,5),i.style.top=t.y-Math.floor(i.clientHeight/2)+"px",i.style.left=t.x-Math.floor(i.clientWidth/2)+"px",i.point=e,this.labels.push(i)),this.areaLabel&&(i=this.areaLabel.label)&&this.areaLabel.p1&&this.areaLabel.p2&&v(i)&&(e={x:(this.areaLabel.p1.x+this.areaLabel.p2.x)/2,y:(this.areaLabel.p1.y+this.areaLabel.p2.y)/2,z:(this.areaLabel.p1.z+this.areaLabel.p2.z)/2},t=d.project(e,this.viewer),i.style.top=t.y-Math.floor(i.clientHeight/2)+"px",i.style.left=t.x-Math.floor(i.clientWidth/2)+"px",i.point=e,this.labels.push(i)),this.viewer.model&&!this.viewer.model.is2d()){var p,m,g=!1;this.labelsStacked=!1;var b=[];for(m=0;m<this.labels.length;m++)b.push({left:this.labels[m].style.left,top:this.labels[m].style.top});for(m=0;m<this.labels.length&&!g;m++)p=this.labels[m],g=this.labelsOverlapDetection(p,this.labels);if(g){for(m=0;m<this.labels.length;m++)this.labels[m].style.left=b[m].left,this.labels[m].style.top=b[m].top;for(this.stackLabels(this.labels),m=0;m<this.labels.length;m++)p=this.labels[m],this.labelsOverlapDetection(p,this.labels)}}this.labels=[]},m.labelsOverlapDetection=function(e,t){for(var i,n,s,a,r,o=!1,l=0;l<t.length;l++){var h=t[l],c=!1;if(e!==h){var u=e.getBoundingClientRect(),d=h.getBoundingClientRect();if(r=u,(a=d).top<r.bottom&&a.bottom>r.top&&(f(d,u)?(n=d,s=u,(i=h).style.left=parseInt(i.style.left,10)-(n.right-s.left)+"px",c=!0):A(d,u)?(w(h,d,u),c=!0):y(d,u)&&(E(h,d,u),c=!0),c)){var p=t.slice(0);p.splice(p.indexOf(e),1),this.labelsOverlapDetection(h,p),h.causeStacking&&e.causeStacking&&(o=!0),h.causeStacking&&this.labelsStacked&&this.stackLabels(this.labels)}}}return o},m.stackLabels=function(e){for(var t=this.lines.xyz.label,i=1;i<e.length;i++){if(e[i].causeStacking){e[i].style.left=t.style.left;var n=e[i-1].getBoundingClientRect(),s=e[i-1]==t?4:0,a=e[i]===t?t.style.top:e[i-1].style.top;e[i].style.top=parseInt(a,10)+n.height+s+"px"}e[i].style.transform=""}this.labelsStacked=!0},m.drawXYZLine=function(e){var t=this,i=e.p1,n=e.p2;if(i&&n){var s=new THREE.Vector3,a=e.geometry=new THREE.Geometry,r=(new THREE.Vector3).subVectors(n,i).normalize().clone().cross(t.viewer.navigation.getEyeVector()).normalize(),o=d.nearestPointInPointToSegment(t.viewer.navigation.getPosition(),i,n),l=t.setScale(o);e.line=this.drawLineSegment(i,n,4,e.material),e.visible=!0,this.segments.push(e),t.showMeasureResult&&(e.tips=[],h(i),h(n))}function h(o){a.vertices=[],s.addVectors(o,r.clone().multiplyScalar(2*l)),a.vertices[0]=s.clone(),s.subVectors(o,r.clone().multiplyScalar(2*l)),a.vertices[1]=s.clone();var h=t.drawLineAsCylinder(a,e.material,3,t.overlayName);t.setCylinderScale(h,i,n),h.visible=!0,e.tips.push(h)}},m.redrawDashedLine=function(){if(this.dashedLine.p1&&this.dashedLine.p2){this.viewer.impl.removeMultipleOverlays(this.overlayName,this.dashedLine.line);var e=this.setScale(this.dashedLine.p2),t=2*e,i=1*e;return this.dashedLine.line=this.drawDashedLine(this.dashedLine.p2,this.dashedLine.p1,t,i,this.lines.xyz.material,3,this.overlayName),this.dashedLine.line}},m.drawLineSegment=function(e,t,i,n,s){var a;if(s)this.dashedLine.p1=e,this.dashedLine.p2=t,a=this.redrawDashedLine();else{var r=new THREE.Geometry;r.vertices.push(e),r.vertices.push(t),a=this.drawLineAsCylinder(r,n,i,this.overlayName),this.setCylinderScale(a,e,t)}return a.visible=!0,a},m.drawSurface=function(e){var t=new Autodesk.Viewing.Extensions.CompGeom.ContourSet;if(t.addContour(e),t.triangulate(),t.triangulationFailed)return!1;var i=t.toPolygonMesh(),n=new THREE.Mesh(i,this.surfaceColor);return this.viewer.impl.addOverlay(this.overlayName,n),!0},m.drawSegmentAndPush=function(e,t,i){if(e&&t){var n=this.drawLineSegment(e,t,4,this.lines.xyz.material,i);if(!i){var s={line:n,p1:e,p2:t};this.segments.push(s)}}},m.renderAreaMeasurementFromPoints=function(e){for(var t,i,n,s=[],a=Object.keys(e),r=0;r<a.length-1;r++){var o=parseFloat(a[r]),l=e[o],h=e[o+1];0===r&&(n=new THREE.Vector3(l.x,l.y,l.z)),t=new THREE.Vector3(l.x,l.y,l.z),i=new THREE.Vector3(h.x,h.y,h.z),this.drawSegmentAndPush(t,i),s.push(t)}a.length>2&&(this.drawSegmentAndPush(n,i,!this.measurement.closedArea),d.isEqualVectors(n,i,d.EPSILON)||s.push(i),0!==this.measurement.area&&this.drawSurface(s)&&(this.showAreaLabel(c(s)),this.updateArea()))},m.renderAreaMeasurement=function(e){for(var t,i,n=this.measurement.countPicks(),s=[],a=1;a<n;a++)t=d.getSnapResultPosition(e[a],this.viewer),i=d.getSnapResultPosition(e[a+1],this.viewer),this.drawSegmentAndPush(t,i),s.push(t);n>2&&(t=d.getSnapResultPosition(e[1],this.viewer),this.drawSegmentAndPush(t,i,!this.measurement.closedArea),d.isEqualVectors(t,i,d.EPSILON)||s.push(i),0!==this.measurement.area&&this.drawSurface(s)&&(this.showAreaLabel(c(s)),this.updateArea()))},m.clearAngleMeshes=function(){this.angleArc&&(this.viewer.impl.removeOverlay(this.overlayName,this.angleArc),this.angleArc=null),this.angleOutline.length>0&&(this.viewer.impl.removeMultipleOverlays(this.overlayName,this.angleOutline),this.angleOutline.length=0)},m.drawAngle=function(e,t,i,n,s,a){this.materialAngle||(this.materialAngle=new THREE.MeshPhongMaterial({color:10066329,ambient:10066329,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),this.materialAngleOutline=new THREE.MeshBasicMaterial({color:16750848,depthTest:!1,depthWrite:!1})),d.createCommonOverlay(this.viewer,this.overlayName),this.clearAngleMeshes();var r=Math.min(e.distanceTo(t),e.distanceTo(i))/4,o=new THREE.CircleGeometry(r,100,0,s*Math.PI/180),l=new THREE.Mesh(o,this.surfaceColor),h=l.geometry.vertices[0].clone();l.geometry.vertices.push(h),l.position.set(e.x,e.y,e.z);var c=l.position.clone();c.add(n),l.lookAt(c),l.updateMatrixWorld();var u=l.geometry.vertices[1].clone(),p=l.geometry.vertices[l.geometry.vertices.length-2].clone();u.applyMatrix4(l.matrixWorld),p.applyMatrix4(l.matrixWorld);var m=new THREE.Vector3,g=new THREE.Vector3,b=new THREE.Vector3,v=new THREE.Vector3;m.subVectors(u,e),g.subVectors(p,e),b.subVectors(t,e),v.subVectors(i,e);var f,A=m.angleTo(b),y=m.angleTo(v),w=g.angleTo(b),E=g.angleTo(v);f=(A<=.001&&A>=-.001||y<=.001&&y>=-.001)&&(w<=.001&&w>=-.001||E<=.001&&E>=-.001)?0:(A<=Math.PI+.001&&A>=Math.PI-.001||y<=Math.PI+.001&&y>=Math.PI-.001)&&(w<=Math.PI+.001&&w>=Math.PI-.001||E<=Math.PI+.001&&E>=Math.PI-.001)?Math.PI:A<=w+.001&&A>=w-.001||A<=E+.001&&A>=E-.001?A:y;var x=new THREE.Matrix4;x.makeRotationAxis(n,f),x.multiply(l.matrix),l.matrix=x,l.rotation.setFromRotationMatrix(l.matrix),l.updateMatrixWorld(),u=l.geometry.vertices[1].clone(),p=l.geometry.vertices[l.geometry.vertices.length-2].clone(),u.applyMatrix4(l.matrixWorld),p.applyMatrix4(l.matrixWorld),m.subVectors(u,e),g.subVectors(p,e),A=m.angleTo(b),y=m.angleTo(v),w=g.angleTo(b),E=g.angleTo(v),A>=.001&&y>=.001&&((x=new THREE.Matrix4).makeRotationAxis(n,2*-f),x.multiply(l.matrix),l.matrix=x,l.rotation.setFromRotationMatrix(l.matrix));var M=new THREE.CircleGeometry(r,100,0,s*Math.PI/180);M.vertices.splice(0,1),l.updateMatrixWorld(),M.applyMatrix(l.matrixWorld),this.angleOutline=this.drawEdgeAsCylinder(M,this.lines.xyz.material,2,0,this.getNewCylinderGeometry()),this.angleArc=l,this.viewer.impl.addOverlay(this.overlayName,this.angleArc),this.viewer.impl.addMultipleOverlays(this.overlayName,this.angleOutline),a.copy(l.geometry.vertices[Math.round(l.geometry.vertices.length/2)-1]),a.applyMatrix4(l.matrixWorld);var T=new THREE.Vector3;T.subVectors(a,e).normalize(),T.multiplyScalar(r/2),a.add(T)},m.renderAngleMeasurementFromPoints=function(e){for(var t,i,n=[],s=Object.keys(e),a=0;a<s.length-1;a++){var r=parseFloat(s[a]),o=e[r],l=e[r+1];t=new THREE.Vector3(o.x,o.y,o.z),i=new THREE.Vector3(l.x,l.y,l.z),this.drawSegmentAndPush(t,i),t&&n.push(t)}if(i&&n.push(i),3===n.length&&this.measurement.angle){var h=new THREE.Vector3,c=new THREE.Vector3,u=new THREE.Vector3;c.subVectors(n[0],n[1]),u.subVectors(n[1],n[2]),h.crossVectors(c,u),h.normalize();var d=new THREE.Vector3;this.drawAngle(n[1],n[0],n[2],h,this.measurement.angle,d),this.showAngleLabel(d),this.updateAngle()}},m.renderAngleMeasurement=function(e){for(var t,i,n=this.measurement.countPicks(),s=[],a=1;a<n;a++)t=d.getSnapResultPosition(e[a],this.viewer),i=d.getSnapResultPosition(e[a+1],this.viewer),this.drawSegmentAndPush(t,i),t&&s.push(t);if(i&&s.push(i),3===s.length&&this.measurement.angle){var r=new THREE.Vector3,o=new THREE.Vector3,l=new THREE.Vector3;o.subVectors(s[0],s[1]),l.subVectors(s[1],s[2]),r.crossVectors(o,l),r.normalize();var h=new THREE.Vector3;this.drawAngle(s[1],s[0],s[2],r,this.measurement.angle,h),this.showAngleLabel(h),this.updateAngle()}},m.createDistanceLabel=function(e){var t=e.label=this.createMeasurementLabel();!function(e,t){var i=e.querySelector(".measure-length-text");i&&(i.style.display=t?"":"none")}(t,e===this.lines.xyz);var i=this.getDocument();if(e.axis){t.className=e.className;var n=i.createElement("div");n.className="measure-label-axis-icon "+e.iconText,n.innerText=e.iconText,t.insertBefore(n,t.firstChild),u.isMobileDevice()||d.safeToggle(t,"enableTransition",!0)}return this.viewer.container.appendChild(t),t},m.updateLine=function(e,t,i,n,s,a,r,o){var l,h=e.line,c=e.label,u=new THREE.Vector3(t,i,n),p=new THREE.Vector3(s,a,r);if((e===this.lines.x&&p.x>u.x||e===this.lines.y&&p.y>u.y||e===this.lines.z&&p.z>u.z)&&(l=u.clone(),u=p.clone(),p=l.clone()),e.line=null,c?this.hideLabel(c):c=this.createDistanceLabel(e),(this.isLeaflet&&e!==this.lines.z||u.distanceTo(p)>=d.EPSILON)&&o)if(e.p1=u,e.p2=p,e===this.lines.xyz)this.drawXYZLine(e),this.showLabel(c),this.updateDistance();else{h=e.line=this.drawLineSegment(u,p,2,e.material);var m=!this.simple&&this.showMeasureResult;h.visible=m,e.visible=m,m?this.showLabel(c):this.hideLabel(c)}},m.renderDistanceMeasurementFromPoints=function(e,t){this.updateLine(this.lines.xyz,e.x,e.y,e.z,t.x,t.y,t.z,!0);var i=this.viewer.navigation.getAlignedUpVector(),n=Math.abs(i.x),s=Math.abs(i.y),a=Math.abs(i.z);a>n&&a>s?(this.updateLine(this.lines.x,e.x,e.y,e.z,t.x,e.y,e.z,!1),this.updateLine(this.lines.y,t.x,e.y,e.z,t.x,t.y,e.z,!1),this.updateLine(this.lines.z,t.x,t.y,e.z,t.x,t.y,t.z,!1)):s>n&&s>a?(this.updateLine(this.lines.x,e.x,e.y,e.z,t.x,e.y,e.z,!1),this.updateLine(this.lines.z,t.x,e.y,e.z,t.x,e.y,t.z,!1),this.updateLine(this.lines.y,t.x,e.y,t.z,t.x,t.y,t.z,!1)):(this.updateLine(this.lines.y,e.x,e.y,e.z,e.x,t.y,e.z,!1),this.updateLine(this.lines.z,e.x,t.y,e.z,e.x,t.y,t.z,!1),this.updateLine(this.lines.x,e.x,t.y,t.z,t.x,t.y,t.z,!1))},m.renderDistanceMeasurement=function(e,t){var i=this;this.updateLine(this.lines.xyz,e.x,e.y,e.z,t.x,t.y,t.z,!0);var n=this.viewer.navigation.getAlignedUpVector(),s=Math.abs(n.x),a=Math.abs(n.y),r=Math.abs(n.z),o=function(e,t){return i.tmpVector.subVectors(e,t),i.tmpVector.normalize(),!d.isParallel(i.tmpVector,i.xAxis)&&!d.isParallel(i.tmpVector,i.yAxis)&&!d.isParallel(i.tmpVector,i.zAxis)}(e,t);r>s&&r>a?(this.updateLine(this.lines.x,e.x,e.y,e.z,t.x,e.y,e.z,o),this.updateLine(this.lines.y,t.x,e.y,e.z,t.x,t.y,e.z,o),this.updateLine(this.lines.z,t.x,t.y,e.z,t.x,t.y,t.z,o)):a>s&&a>r?(this.updateLine(this.lines.x,e.x,e.y,e.z,t.x,e.y,e.z,o),this.updateLine(this.lines.z,t.x,e.y,e.z,t.x,e.y,t.z,o),this.updateLine(this.lines.y,t.x,e.y,t.z,t.x,t.y,t.z,o)):(this.updateLine(this.lines.y,e.x,e.y,e.z,e.x,t.y,e.z,o),this.updateLine(this.lines.z,e.x,t.y,e.z,e.x,t.y,t.z,o),this.updateLine(this.lines.x,e.x,t.y,t.z,t.x,t.y,t.z,o))},m.updateResults=function(){this.updateDistance(),this.updateAngle(),this.updateArea(),setTimeout(function(){this.viewer.impl&&this.updateLabelsPosition()}.bind(this),0)},m.updateDistance=function(){function e(e,t){e&&(e.style.width=t)}function t(e){return e?e.clientWidth:0}Object.keys(this.lines).forEach(function(t){e(this.lines[t].label,"")}.bind(this)),M(this.lines.x.label,"~ "+this.measureTool.getDistanceX(this.measurement)),M(this.lines.y.label,"~ "+this.measureTool.getDistanceY(this.measurement)),M(this.lines.z.label,"~ "+this.measureTool.getDistanceZ(this.measurement)),x(this.lines.xyz.label,"~ "+this.measureTool.getDistanceXYZ(this.measurement)),this.viewer.model&&this.viewer.model.is3d()&&setTimeout(function(){var i=Math.max(t(this.lines.x.label),t(this.lines.y.label),t(this.lines.z.label),t(this.lines.xyz.label));Object.keys(this.lines).forEach(function(t){e(this.lines[t].label,i+"px")}.bind(this))}.bind(this),0)},m.updateAngle=function(){x(this.angleLabel.label,"~ "+this.measureTool.getAngle(this.measurement))},m.updateArea=function(){x(this.areaLabel.label,"~ "+this.measureTool.getArea(this.measurement))},m.setSimple=function(e){if(this.simple!=e){this.simple=e;var t=!e;this.setLineVisible(this.lines.x,t),this.setLineVisible(this.lines.y,t),this.setLineVisible(this.lines.z,t),this.updateLabelsPosition(),this.viewer.impl.invalidate(!1,!1,!0)}},m.setLineVisible=function(e,t){e.line&&(e.line.visible=t,e.visible=t,e.label&&(t?this.showLabel(e.label):(this.hideLabel(e.label),e.label.style.opacity=0)))},m.enableLabelsTouchEvents=function(e){var t=e?"all":"none";this.lines.xyz.label&&(this.lines.xyz.label.style.pointerEvents=t),this.angleLabel.label&&(this.angleLabel.label.style.pointerEvents=t),this.areaLabel.label&&(this.areaLabel.label.style.pointerEvents=t)},m.setLabelsZIndex=function(e){for(var t in this.lines)if(this.lines.hasOwnProperty(t)){var i=this.lines[t];i.label&&(i.label.style.zIndex=e)}for(t in this.angleLabel&&this.angleLabel.label&&(this.angleLabel.label.style.zIndex=e),this.areaLabel&&this.areaLabel.label&&(this.areaLabel.label.style.zIndex=e),this.endpoints)if(this.endpoints.hasOwnProperty(t)){var n=this.endpoints[t];n.label&&(n.label.style.zIndex=e-1)}},m.focusLabels=function(){this.setLabelsZIndex(3)},m.unfocusLabels=function(){this.setLabelsZIndex(2)},m.clear=function(){var e;for(e in this.endpoints)if(this.endpoints.hasOwnProperty(e)){var t=this.endpoints[e];t.label&&this.hideLabel(t.label)}for(e in this.lines)if(this.lines.hasOwnProperty(e)){var i=this.lines[e];i.line&&(i.line.visible=!1,i.visible=!1,i.tips&&i.tips.forEach((function(e){e.visible=!1}))),i.label&&(this.hideLabel(i.label),i.label.style.opacity=0,i.label.style.zIndex=2)}this.angleLabel&&this.angleLabel.label&&this.hideLabel(this.angleLabel.label),this.areaLabel&&this.areaLabel.label&&this.hideLabel(this.areaLabel.label),this.clearSelectionAreas(),this.segments=[],this.dashedLine={},this.viewer.impl.clearOverlay(this.overlayName),d.createCommonOverlay(this.viewer,this.overlayName)},m.hideClick=function(e){for(var t in l.prototype.hideClick.call(this,e),this.lines)if(this.lines.hasOwnProperty(t)){var i=this.lines[t];i.line&&(i.line.visible=!1,i.visible=!1,i.tips&&i.tips.forEach((function(e){e.visible=!1}))),i.label&&(this.hideLabel(i.label),i.label.style.opacity=0)}this.angleLabel&&this.angleLabel.label&&this.hideLabel(this.angleLabel.label),this.areaLabel&&this.areaLabel.label&&this.hideLabel(this.areaLabel.label),this.enableSelectionAreas(i.selectionArea,!1)},m.destroy=function(){var e;for(e in l.prototype.destroy.call(this),this.lines)if(this.lines.hasOwnProperty(e)){var t=this.lines[e];t.line&&(this.viewer.impl.clearOverlay(self.overlayName),t.material=t.line=t.geometry=null),t.label&&("xyz"===e&&(t.label.addEventListener("mousewheel",this.viewer.toolController.mousewheel),t.label.removeEventListener("click",this.onSelectionAreaClickedBinded)),t.label.parentNode.removeChild(t.label),t.label=null),t.material=t.line=t.geometry=t.label=t.p1=t.p2=null}this.clearAngleMeshes(),this.angleLabel&&this.angleLabel.label&&(this.angleLabel.label.parentNode.removeChild(this.angleLabel.label),this.angleLabel.label.removeEventListener("mousewheel",this.viewer.toolController.mousewheel),this.angleLabel.label.removeEventListener("click",this.onSelectionAreaClickedBinded),this.angleLabel.label=this.angleLabel.p1=this.angleLabel.p2=null),this.areaLabel&&this.areaLabel.label&&(this.areaLabel.label.parentNode.removeChild(this.areaLabel.label),this.areaLabel.label.removeEventListener("mousewheel",this.viewer.toolController.mousewheel),this.areaLabel.label.removeEventListener("click",this.onSelectionAreaClickedBinded),this.areaLabel.label=this.areaLabel.p1=this.areaLabel.p2=null),this.viewer.impl.overlayScenes[this.overlayName]&&this.viewer.impl.removeOverlayScene(this.overlayName),this.viewer.removeEventListener(u.CAMERA_CHANGE_EVENT,this.onCameraChangeBinded),this.removeWindowEventListener("mouseup",this.handleButtonUpBinded)},m.clearXYZLine=function(){this.viewer.impl.removeOverlay(this.overlayName,this.lines.xyz.line),this.lines.xyz.tips&&this.lines.xyz.tips.forEach(function(e){this.viewer.impl.removeOverlay(this.overlayName,e)}.bind(this))},m.updateScale=function(){var e,t=this;for(e in this.angleOutline.forEach((function(e){return t.setCylinderScale(e)})),this.lines)if(this.lines.hasOwnProperty(e)){var i=this.lines[e];i.line&&i!==this.lines.xyz&&this.setCylinderScale(i.line,i.p1,i.p2)}for(e in this.segments)if(this.segments.hasOwnProperty(e)){var n=this.segments[e];n.line&&this.setCylinderScale(n.line,n.p1,n.p2)}this.measurement.measurementType===d.MeasurementTypes.MEASUREMENT_DISTANCE&&this.measurement.isComplete()&&(this.clearXYZLine(),this.drawXYZLine(this.lines.xyz))},m.setNoTopology=function(){this.topologyStatus=b,this.lines.xyz.label&&(T(this.lines.xyz.label,!1,this.topologyStatus),this.lines.xyz.label.classList.remove("fetching-topology"))},m.setFetchingTopology=function(){this.topologyStatus=1,this.lines.xyz.label&&(T(this.lines.xyz.label,!0,this.topologyStatus),this.lines.xyz.label.classList.add("fetching-topology"))},m.setTopologyAvailable=function(){this.topologyStatus=2,this.lines.xyz.label&&(T(this.lines.xyz.label,!1,this.topologyStatus),this.lines.xyz.label.classList.remove("fetching-topology"))},m.createMeasurementLabel=function(){var e=this.getDocument(),t=e.createElement("div");t.className="measure-length";var i=e.createElement("div");i.className="measure-fetching-topology",i.style.display="none",t.appendChild(i);var n=e.createElement("div");n.className="measure-length-text",t.appendChild(n);var s=e.createElement("div");return s.className="measure-delta-text",t.appendChild(s),t.causeStacking=!0,u.isMobileDevice()||d.safeToggle(t,"enable-hover",!0),t},m.createSnapResultLabel=function(e){var t=this.getDocument(),i=t.createElement("div");i.className="measure-label";var n=t.createElement("div");if(n.className="measure-label-icon",i.appendChild(n),u.isTouchDevice()){this.initLabelMobileGestures(i,e,this.measureTool);var s=t.createElement("div");s.className="measure-label-hit-area",i.appendChild(s)}return u.isMobileDevice()||(this.initMouseEvent(i,e),i.addEventListener("mousewheel",this.viewer.toolController.mousewheel),d.safeToggle(i,"enable-hover",!0)),i.causeStacking=!1,i},m.showAngleLabel=function(e){var t=this.angleLabel.label;t||(t=this.angleLabel.label=this.createMeasurementLabel(),this.viewer.container.appendChild(t),t.addEventListener("mousewheel",this.viewer.toolController.mousewheel),t.addEventListener("click",this.onSelectionAreaClickedBinded)),this.updateAngle(),this.showLabel(t),this.angleLabel.p1=e.clone(),this.angleLabel.p2=e.clone()},m.showAreaLabel=function(e){var t=this.areaLabel.label;t||(t=this.areaLabel.label=this.createMeasurementLabel(),this.viewer.container.appendChild(t),t.addEventListener("mousewheel",this.viewer.toolController.mousewheel),t.addEventListener("click",this.onSelectionAreaClickedBinded)),this.updateArea(),this.showLabel(t),this.areaLabel.p1=e,this.areaLabel.p2=e},m.onSelectionAreaClicked=function(){this.measureTool.selectMeasurementById(this.measurement.id)},m.createSelectionArea=function(){var e=this.getDocument().createElement("div");return e.id="measurement-selection-area-"+this.measurement.id,this.viewer.container.appendChild(e),e.className="measure-selection-area",e.style.display="none",e.addEventListener("mousewheel",this.viewer.toolController.mousewheel),e.addEventListener("click",this.onSelectionAreaClickedBinded),e},m.updateSelectionArea=function(){this.segments.forEach(function(e){if(e.p1&&e.p2){var t=d.project(e.p1,this.viewer),i=d.project(e.p2,this.viewer);e.selectionArea||(e.selectionArea=this.createSelectionArea());var n=e.selectionArea,s=new THREE.Vector2;n.style.top=t.y-7.5+"px",n.style.left=t.x+"px",n.style.width=s.subVectors(t,i).length()+"px",n.style.height="15px";var a,r=t.x-i.x,o=t.y-i.y;a=180*Math.atan2(-o,-r)/Math.PI,n.style.transform="rotate("+a+"deg)",n.style.transformOrigin="0px 7.5px"}}.bind(this)),this.measureTool.areAllPicksSet()&&this.enableSelectionAreas(!0)},m.clearSelectionAreas=function(){var e=this.getDocument();this.segments.forEach(function(t){if(t.selectionArea){t.selectionArea.removeEventListener("mousewheel",this.viewer.toolController.mousewheel),t.selectionArea.removeEventListener("click",this.onSelectionAreaClickedBinded);var i=e.getElementById("measurement-selection-area-"+this.measurement.id);i&&i.parentNode.removeChild(i),t.selectionArea=null}}.bind(this))},m.enableSelectionAreas=function(e){this.segments.forEach(function(t){t.selectionArea&&(t.selectionArea.style.display=e?"block":"none")}.bind(this))},m.render=function(e,t){l.prototype.render.call(this,e,t),this.updateSelectionArea()},m.renderFromPoints=function(e,t){l.prototype.renderFromPoints.call(this,e,t),this.updateSelectionArea()},m.onCameraChange=function(){this.redrawDashedLine(),this.updateSelectionArea(),this.hideLabelsOutsideOfView(),this.updateLabelsPosition()},m.handleResize=function(){this.redrawDashedLine(),this.updateSelectionArea(),this.updateLabelsPosition()},Autodesk.Viewing.GlobalManagerMixin.call(k.prototype);var C=Autodesk.Viewing,L=Autodesk.Viewing.MeasureCommon;function S(e,t,i){l.call(this,e,t,i),this.calibrationTool=i,this.calibrationLabel=null,this.endpoints=null,this.tmpVector=new THREE.Vector3,this.p1=null,this.p2=null,this.rubberbandDefaultMaterial=new THREE.MeshBasicMaterial({color:15249964,opacity:1,transparent:!1,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),this.rubberbandSnappedMaterial=new THREE.MeshBasicMaterial({color:23502,opacity:1,transparent:!1,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),this.rubberbandTipMaterial=new THREE.MeshBasicMaterial({color:0,opacity:1,transparent:!1,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide})}S.prototype=Object.create(l.prototype),S.prototype.constructor=S;var R=S.prototype;function P(e,t){return e.right>=t.left&&e.right<=t.right}function B(e,t){return e.left>=t.left&&e.left<=t.right}function N(e,t){return e.left<=t.left&&e.right>=t.right}function V(e,t,i){e.style.left=parseInt(e.style.left,10)+(i.right-t.left)+"px"}function D(e,t,i){e.style.top=parseInt(e.style.top,10)+(i.bottom-t.top)+"px"}R.createEndpoint=function(e){this.endpoints[e]={},this.endpoints[e].position=null;var t=this.getDocument(),i=this.endpoints[e].label=t.createElement("div");i.className="calibration-endpoint",this.viewer.container.appendChild(i);var n=t.createElement("div");n.className="calibration-endpoint-text",n.textContent=e.toString(),i.appendChild(n),C.isTouchDevice()&&this.initLabelMobileGestures(i,e,this.calibrationTool),C.isMobileDevice()||(L.safeToggle(i,"enable-hover",!0),this.initMouseEvent(i,e),i.addEventListener("mousewheel",this.viewer.toolController.mousewheel))},R.init=function(){if(L.createCommonOverlay(this.viewer,this.overlayName),!this.calibrationLabel){var e=this.getDocument();this.calibrationLabel=e.createElement("div"),this.calibrationLabel.className="calibration-label",this.hideLabel(this.calibrationLabel),this.viewer.container.appendChild(this.calibrationLabel),this.calibrationLabel.addEventListener("mousewheel",this.viewer.toolController.mousewheel);var t=e.createElement("div");t.className="calibration-label-text",this.calibrationLabel.appendChild(t)}this.endpoints=[],this.handleButtonUpBinded=this.calibrationTool.handleButtonUp.bind(this.calibrationTool),this.addWindowEventListener("mouseup",this.handleButtonUpBinded),this.onCameraChangeBinded=this.onCameraChange.bind(this),this.viewer.addEventListener(C.CAMERA_CHANGE_EVENT,this.onCameraChangeBinded)},R.destroy=function(){this.clear(),l.prototype.destroy.call(this),this.calibrationLabel&&(this.calibrationLabel.removeEventListener("mousewheel",this.viewer.toolController.mousewheel),this.viewer.container.removeChild(this.calibrationLabel),this.calibrationLabel=null),this.viewer.impl.clearOverlay(this.overlayName),this.viewer.impl.removeOverlayScene(this.overlayName),this.removeWindowEventListener("mouseup",this.handleButtonUpBinded),this.viewer.removeEventListener(C.CAMERA_CHANGE_EVENT,this.onCameraChangeBinded)},R.clearRubberband=function(){this.viewer.impl.clearOverlay(this.overlayName)},R.clear=function(){for(var e in this.clearRubberband(),this.hideLabel(this.calibrationLabel),this.endpoints)this.endpoints.hasOwnProperty(e)&&(this.hideClick(e),this.endpoints[e].position=null)},R.updateLabelValue=function(e){e&&""!==e?(this.calibrationLabel.childNodes[0].setAttribute("data-i18n",e),this.calibrationLabel.childNodes[0].textContent=C.i18n.translate(e),this.showLabel(this.calibrationLabel),this.calibrationTool.render()):(this.calibrationLabel.childNodes[0].textContent=null,this.hideLabel(this.calibrationLabel))},R.changeLabelClickableMode=function(e){this.calibrationLabel.childNodes[0].style.pointerEvents=e?"all":"none"},R.showAddCalibrationLabel=function(){var e=this;this.updateLabelValue("Add Calibration"),this.changeLabelClickableMode(!0),this.calibrationTool.render(),this.calibrationLabel.addEventListener("click",(function t(){e.calibrationLabel.childNodes[0].style.pointerEvents="none",e.calibrationTool.render(),e.updateLabelValue(null),e.calibrationTool.showPanel(),e.calibrationLabel.removeEventListener("click",t)}))},R.updateLabelsPosition=function(){for(var e=1;e<=Object.keys(this.endpoints).length;e++)if(this.endpoints[e].position){var t=this.endpoints[e].label,i=L.project(this.endpoints[e].position,this.viewer,15);t.style.left=i.x-parseInt(t.clientWidth)/2+"px",t.style.top=i.y-parseInt(t.clientHeight)/2+"px",t.point=this.endpoints[e].position,this.labelsOverlapDetection(this.endpoints[e].label,this.endpoints)}this.hideLabelsOutsideOfView()},R.labelsOverlapDetection=function(e,t){for(var i=1;i<=Object.keys(t).length;i++){var n=t[i].label;if(e!==n){var s=e.getBoundingClientRect(),a=n.getBoundingClientRect();c=s,(h=a).top<c.bottom&&h.bottom>c.top&&(P(a,s)?(o=a,l=s,(r=n).style.left=parseInt(r.style.left,10)-(o.right-l.left)+"px"):B(a,s)?V(n,a,s):N(a,s)&&D(n,a,s))}}var r,o,l,h,c},R.renderCalibrationLabel=function(){if(this.showMeasureResult&&this.calibrationLabel&&this.p1&&this.p2){var e={x:(this.p1.x+this.p2.x)/2,y:(this.p1.y+this.p2.y)/2,z:(this.p1.z+this.p2.z)/2},t=L.project(e,this.viewer);this.labelPosition=new THREE.Vector2(t.x,t.y),this.calibrationLabel.childNodes[0].textContent&&this.showLabel(this.calibrationLabel),this.calibrationLabel.style.top=this.labelPosition.y-Math.floor(this.calibrationLabel.clientHeight/2)+"px",this.calibrationLabel.style.left=this.labelPosition.x-Math.floor(this.calibrationLabel.clientWidth/2)+"px",this.calibrationLabel.point=e,this.viewer.model.is2d()&&this.alignLabelWithLine(this.calibrationLabel,this.p1,this.p2,this.calibrationLabel.clientHeight,this.viewer)}},R.drawMeasurementLineTip=function(e,t,i,n){var s=new THREE.Vector3,a=new THREE.Geometry,r=this.setScale(e);n=n?-1:1;var o=this.snapper.isSnapped()&&!this.showMeasureResult?this.rubberbandSnappedMaterial:this.rubberbandTipMaterial;s.addVectors(e,i.clone().multiplyScalar(5*r)),a.vertices[0]=s.clone(),s.subVectors(e,i.clone().multiplyScalar(5*r)),a.vertices[1]=s.clone(),this.drawLineAsCylinder(a,o,1.5,this.overlayName),a.vertices[0]=e,s.subVectors(e,t.clone().multiplyScalar(5*r*n)),a.vertices[1]=s.clone(),this.drawLineAsCylinder(a,o,1.5,this.overlayName),s.addVectors(e,i.clone().multiplyScalar(3*r)),a.vertices[0]=s.clone(),s.subVectors(e,i.clone().multiplyScalar(3*r)),a.vertices[1]=s.clone(),this.drawLineAsCylinder(a,this.rubberbandDefaultMaterial,2,this.overlayName),s.addVectors(e,i.clone().multiplyScalar(3*r)),s.addVectors(s,t.clone().multiplyScalar(3*r)),a.vertices[0]=s.clone(),s.subVectors(e,i.clone().multiplyScalar(3*r)),s.subVectors(s,t.clone().multiplyScalar(3*r)),a.vertices[1]=s.clone(),this.drawLineAsCylinder(a,this.rubberbandDefaultMaterial,2,this.overlayName)},R.renderDistanceMeasurement=function(e,t){if(this.viewer.impl.clearOverlay(this.overlayName),e&&t){var i=new THREE.Geometry,n=(new THREE.Vector3).subVectors(t,e).normalize(),s=n.clone().cross(this.viewer.navigation.getEyeVector()).normalize(),a=this.setScale(e),r=2*a,o=1*a,l=(Math.abs(e.x-t.x)<=.1||Math.abs(e.y-t.y)<=.1||this.snapper.getSnapResult().isPerpendicular)&&!this.showMeasureResult?this.rubberbandSnappedMaterial:this.rubberbandDefaultMaterial;this.showMeasureResult?(i.vertices[0]=e,i.vertices[1]=t,this.drawLineAsCylinder(i,l,3,this.overlayName)):this.drawDashedLine(e,t,r,o,l,3,this.overlayName),this.drawMeasurementLineTip(e,n,s,!1),this.showMeasureResult&&this.drawMeasurementLineTip(t,n,s,!0),this.p1=e,this.p2=t,this.renderCalibrationLabel()}},R.onCameraChange=function(){this.measurement.isComplete()&&this.renderDistanceMeasurement(this.p1,this.p2),this.updateLabelsPosition()};var I=Autodesk.Viewing,O=Autodesk.Viewing.Extensions,z=Autodesk.Viewing.Private,G=Autodesk.Viewing.UI,U=Autodesk.Viewing.MeasureCommon,F=G&&G.DockingPanel||function(){return function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}}(),Y=O&&O.ViewerPanelMixin||function(){},H=I.getGlobal().document,W=function(e,t,i,n,s){var a=this;(s=s||{}).addFooter=!1,F.call(this,t.container,i,n,s),this.viewer=t,this.calibrationTool=e,this.parentContainer=t.container,this.container.style.left="0px",this.container.style.top="0px",this.container.style.resize="none",this.container.classList.add("calibration-panel"),this.setGlobalManager&&this.setGlobalManager(t.globalManager),this.addEventListener(this.closer,"click",(function(e){a.setVisible(!1),a.calibrationTool.clearSize(),a.calibrationTool.showAddCalibrationLabel()})),s.heightAdjustment||(s.heightAdjustment=40),s.marginTop||(s.marginTop=0),s.left=!1,this.createScrollContainer(s);var r=this.getDocument&&this.getDocument()||H;this.calibrationMenu=r.createElement("div"),this.scrollContainer.appendChild(this.calibrationMenu),this.table=r.createElement("table"),this.table.className="adsk-lmv-tftable calibration-table",this.tbody=r.createElement("tbody"),this.table.appendChild(this.tbody),this.calibrationMenu.appendChild(this.table),this.row=this.tbody.insertRow(0),this.requestedSizeTextbox=r.createElement("input"),this.requestedSizeTextbox.className="docking-panel-textbox",this.requestedSizeTextbox.type="text",this.requestedSizeTextbox.autofocus="true",this.addEventListener(this.requestedSizeTextbox,"keyup",(function(e){var t=a.requestedSizeTextbox.value;""!==t&&""===t.split(".")[0]&&(a.requestedSizeTextbox.value="0"+t),a.updateLabel()})),this.addEventListener(this.requestedSizeTextbox,"keypress",(function(e){var t=e.key||String.fromCharCode(e.keyCode);if("Backspace"!=t&&"ArrowLeft"!=t&&"ArrowRight"!=t){if(e.keyCode==I.KeyCode.ESCAPE)return a.setVisible(!1),a.calibrationTool.clearSize(),void a.calibrationTool.showAddCalibrationLabel();var i=a.requestedSizeTextbox.value,n=a.requestedSizeTextbox.selectionStart;if("."!=(i=[i.slice(0,n),t,i.slice(n)].join(""))){var s=a.units[a.unitList.selectedIndex].simpleInput;(!Z(i)||s&&(!j(i)||Autodesk.Viewing.Private.calculatePrecision(i)>a.calibrationTool.getMaxPrecision()))&&e.preventDefault()}}}));var o=this.row.insertCell(0);this.caption=r.createElement("div"),this.caption.setAttribute("data-i18n","Define Size"),this.caption.textContent=I.i18n.translate("Define Size"),o.appendChild(this.caption),(o=this.row.insertCell(1)).appendChild(this.requestedSizeTextbox),this.units=[{name:"Feet and fractional inches",units:"ft-and-fractional-in",matches:["ft-and-fractional-in"],simpleInput:!1},{name:"Feet and decimal inches",units:"ft-and-decimal-in",matches:["ft-and-decimal-in"],simpleInput:!1},{name:"Meters",units:"m",matches:["m"],simpleInput:!0},{name:"Centimeters",units:"cm",matches:["cm"],simpleInput:!0},{name:"Millimeters",units:"mm",matches:["mm"],simpleInput:!0}];for(var l=[],h=0;h<this.units.length;++h)l.push(this.units[h].name);this.unitList=new z.OptionDropDown("Unit type",this.tbody,l,0,null,{paddingLeft:0,paddingRight:15}),this.unitList.setGlobalManager(this.globalManager),this.addEventListener(this.unitList,"change",(function(e){a.updateLabel()}));var c=r.createElement("div");c.classList.add("docking-panel-primary-button"),c.classList.add("calibration-button"),c.setAttribute("data-i18n","Set Calibration"),c.textContent=I.i18n.translate("Set Calibration"),c.addEventListener("click",(function(){var e=a.unitList.selectedIndex,t=a.units[e].units;a.calibrationTool.calibrate(t,a.requestedSizeTextbox.value)}),!1),this.calibrationMenu.appendChild(c)},Z=function(e){return e.match(/^(\d+)/)},j=function(e){return e+="0",!isNaN(parseFloat(e))&&!isNaN(+e)&&parseFloat(e)>=0};W.prototype=Object.create(F.prototype),Y.call(W.prototype),W.prototype.uninitialize=function(){this.viewer=null,F.prototype.uninitialize.call(this)},W.prototype.findUnits=function(){var e,t,i=this.calibrationTool.getCurrentUnits();for(e=0;e<this.units.length;++e){var n=this.units[e].matches;if(n)for(t=0;t<n.length;++t)if(n[t]===i)return e}return 0},W.prototype.setPanelValue=function(e){this.unitList.setSelectedIndex(this.findUnits()),this.requestedSizeTextbox.value=e},W.prototype.updateLabel=function(){var e=this.unitList.selectedIndex,t=this.units[e].units,i=this.requestedSizeTextbox.value,n=Autodesk.Viewing.Private.UnitParser.parsePositiveNumber(i,t),s=Autodesk.Viewing.Private.formatValueWithUnits(n,t,3,Autodesk.Viewing.Private.calculatePrecision(i));""===i?this.calibrationTool.updateLabelValue(null):isNaN(n)||this.calibrationTool.updateLabelValue(s)},W.prototype.updatePanelPosition=function(e,t,i,n){var s,a,r=parseInt(this.container.getBoundingClientRect().width),o=parseInt(this.container.getBoundingClientRect().height);if(e&&t&&i){t=U.project(t,this.viewer),i=U.project(i,this.viewer);var l,h=(new THREE.Vector2).copy(t).sub(i).normalize();l=t.x<i.x?new THREE.Vector2(h.y,-h.x):new THREE.Vector2(-h.y,h.x);var c=n+Math.sqrt(Math.pow(r,2)+Math.pow(o,2))/2;l=l.multiplyScalar(c);var u=e.sub(l);s=u.x-Math.floor(r/2),a=u.y-Math.floor(o/2),(s<0||s+r>this.viewer.canvas.clientWidth||a<0||a+o>this.viewer.canvas.clientHeight)&&(s=Math.floor((this.viewer.canvas.clientWidth-r)/2),a=Math.floor((this.viewer.canvas.clientHeight-o)/2))}else s=Math.floor((this.viewer.canvas.clientWidth-r)/2),a=Math.floor((this.viewer.canvas.clientHeight-o)/2);this.container.style.left=s+"px",this.container.style.top=a+"px"};var Q=function(e,t,i,n,s){var a=this;(s=s||{}).addFooter=!1,F.call(this,t.container,i,n,s),this.viewer=t,this.measureExt=e,this.parentContainer=t.container,this.container.classList.add("calibration-panel"),this.container.style.width="380px",this.container.style.height="190px",this.setGlobalManager&&this.setGlobalManager(t.globalManager),s.heightAdjustment||(s.heightAdjustment=70),s.marginTop||(s.marginTop=0),s.left=!1;var r=this.getDocument&&this.getDocument()||H;this.createScrollContainer(s),this.dialogBox=r.createElement("div"),this.scrollContainer.appendChild(this.dialogBox);var o=r.createElement("div");o.className="calibration-text";var l="Calibration Message";o.setAttribute("data-i18n",l),o.textContent=I.i18n.translate(l),this.dialogBox.appendChild(o);var h=r.createElement("div");h.className="calibration-buttons-wrapper",this.dialogBox.appendChild(h);var c=r.createElement("div");c.classList.add("docking-panel-secondary-button"),c.classList.add("calibration-button-left"),c.setAttribute("data-i18n","Cancel"),c.textContent=I.i18n.translate("Cancel"),c.addEventListener("click",(function(){a.setVisible(!1)}),!1),h.appendChild(c);var u=r.createElement("div");u.classList.add("docking-panel-primary-button"),u.classList.add("calibration-button-right"),u.setAttribute("data-i18n","Calibrate Now"),u.textContent=I.i18n.translate("Calibrate Now"),u.addEventListener("click",(function(){a.measureExt.enableCalibrationTool(!0),a.setVisible(!1)}),!1),h.appendChild(u)};Q.prototype=Object.create(F.prototype),Y.call(Q.prototype),Q.prototype.uninitialize=function(){this.viewer=null,F.prototype.uninitialize.call(this)};var X=Autodesk.Viewing,_=function(e,t,i,n){var s=Autodesk.Viewing,a=(Autodesk.Viewing.Extensions.Measure,Autodesk.Viewing.MeasureCommon),r=["calibration"],o=e,l=new a.Measurement(a.MeasurementTypes.MEASUREMENT_DISTANCE),h=t||{};this.setGlobalManager(e.globalManager);var c=i,u=t.maxPrecision||5,d=null!=i.calibrationFactor,p=n,m=!1,g=!1,b=!1,v=null,f=!1,A=null,y=null,w=null,E=null,x=!1,M=[],T=null,k=0,C=!1,L=!1,R=!1,P=null,B=null,N=null,V=Autodesk.Viewing.GuiViewer3D&&e instanceof Autodesk.Viewing.GuiViewer3D;a=Autodesk.Viewing.MeasureCommon;function D(){switch(k){case 0:return null;case 1:case 2:return l.getPick(k);case 3:return l.getPick(l.countPicks())}}function I(){switch(k){case 0:return null;case 1:return l.getPick(l.countPicks());case 2:case 3:return l.getPick(1)}}function O(){k=0}function z(){k=3,l.indicator.changeAllEndpointsEditableStyle(!0)}function G(){return 0===k}function U(){return 3===k}this.register=function(){V&&!N&&(N=new W(this,o,"calibration-panel","Calibration",h),o.addPanel(N)),this.onCameraChangeBinded=this.onCameraChange.bind(this),this.screenSizeChangedBinded=this.screenSizeChanged.bind(this)},this.deregister=function(){this.deactivate(),N&&(o.removePanel(N),N.uninitialize(),N=null)},this.isActive=function(){return m},this.getNames=function(){return r},this.getName=function(){return r[0]},this.getPriority=function(){return 50},this.getCursor=function(){return g?null:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAYCAYAAAD+vg1LAAAAAXNSR0IArs4c6QAAAwZJREFUSA2tVEtLW0EUvjGJefoqSY0x0WBSiY+oNWiUINkU6ioLaaAlG1eudNVFoT+grgopiCkEIbUK1o0lusmurRSEWmmKG6MNtNhNosWqyU2CZPpN8cr15nFD7YHDzHnON2fOGYZhmHkw4XEW+wD4xkT4lMvl6CE0+Y2ohh+dz+cZn89HVS/5+n/d/wVMkXq9Xor2v5SBgsmymQwZHx+vOqlKpXKDXWI3eU6Tg+kqSjSh3W4/s9lsvzUajaNcAK3xY7Dyci3nd6WXSCS60dHRvMfjSRcKBfWV4SYbrVarB8p0PB5nY7HYmdVq/aDX67WlckpKKcvpOjs7X09OTvoPDw8z2Wy2Bu+imJqa+npycnJXGHOt3YRGoSyVSvvMZrNkYWFBs7GxkaoBAXFJcDJhcCW5rq5ur62trQ/EOhyOBhDT2Nj4qVKMqA31ve1yub7Rfufo/PycDA4OxpuamhqECaouhVqtfuD3+1tqa2uZQCCQDoVCWTwknVQDDvIKE1clI1ja09Ozg0cjx8fHpL+/P+50OhMU8f7+Punt7f2I5NdqXRXi9fV1z9jYWCuIWV5eziSTyWAqlXq1urqaw6AwOMiCG4lOYtEturu732xubhK0FQHSvfr6+lsog4HWPIPvIBqNErRiqCiwkkKpVFowZd8xZSQYDLImk+kJ52+xWJ4tLS3hU8yTkZGRBD2Ms4mu6Nun4XA4f3p6SoaGhuJ0+rgg/Bsmt9udYFmWzM3NZdDT05ztWsE5JV0R1AqUCfTt0fb2tjESiRRmZmaOUOcI3w9DY5mdnb03PDzMoDQ/MZFRzM20lO/E38vl8vt46UdAq0WNJWixlEwmu8B1bXioOxwjpgXJ0hMTE1og1qysrDghf+HnKtoD7c7u7i5ZXFzMGY3GF7iFuRR3dHTMr62tXWxtbZH29vZ3RYmECozu54ODAzpdP2hphHZOVigUVjChvgMDA+85fdm1q6vrrU6n+4WR9Zd1ujQ0Nzc/NBgMScSExXwZ2j5oL5Wo46UD/ZvxUemo+AdW1zJzUYr16wAAAABJRU5ErkJggg==), auto"},this.activate=function(){if(m=!0,g=!1,this.isEditingEndpoint=!1,this.editByDrag=!1,O(),o.toolController.activateTool(p.getName()),o.toolController.activateTool("magnifyingGlass"),l.indicator||l.attachIndicator(o,this,S),l.indicator.clear(),f&&w&&E){l.setPick(1,w.clone()),l.setPick(2,E.clone()),z();var e=Autodesk.Viewing.Private.UnitParser.parsePositiveNumber(A,y);l.indicator.updateLabelValue(Autodesk.Viewing.Private.formatValueWithUnits(e,y,3,c.precision)),v=l.distanceXYZ,l.indicator.changeLabelClickableMode(!1),x=!0;var t=this.render();l.indicator.changeAllEndpointsEditableStyle(!0),t&&(N&&N.setPanelValue(A),this.showPanel())}o.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangeBinded),o.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.screenSizeChangedBinded)},this.deactivate=function(){m&&(m=!1,this.hidePanel(),this.updateViewportId(!0),x=!1,l.clearAllPicks(),p&&p.isActive()&&o.toolController.deactivateTool(p.getName()),o.toolController.deactivateTool("magnifyingGlass"),l.indicator&&(l.indicator.clear(),l.indicator.destroy(),l.indicator=null),o.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChangeBinded),o.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.screenSizeChangedBinded))},this.getActivePointIndex=function(){return k},this.setCalibrationFactor=function(e){c.calibrationFactor=e},this.getCalibrationFactor=function(){return c.calibrationFactor},this.updateLabelValue=function(e){l.indicator.updateLabelValue(e)},this.isCalibrationValid=function(e,t){var i=Autodesk.Viewing.Private.UnitParser.parsePositiveNumber(t,e);return!isNaN(i)},this.calibrate=function(e,t){var i=null,n=Autodesk.Viewing.Private.UnitParser.parsePositiveNumber(t,e);if(!isNaN(n)){var s=Autodesk.Viewing.Private.convertUnits(o.model.getUnitString(),e,1,v);if(0!==s&&!isNaN(s)){i=n/s,c.calibrationFactor=i,c.units=e;var r=o.model.is2d()?3:1,h=Autodesk.Viewing.Private.calculatePrecision(t);c.precision=Math.max(c.precision?c.precision:r,h),A=t,y=e,d=!0,f=!0,w=l.getPick(1).clone(),E=l.getPick(2).clone()}}i&&(o.getExtension("Autodesk.Measure").enableCalibrationTool(!1),o.dispatchEvent({type:a.Events.FINISHED_CALIBRATION,units:e,scaleFactor:i,size:t}))},this.calibrateByScale=function(e,t){c.calibrationFactor=t,c.units!==e&&(c.units=e,y=e),d=!0},this.getCurrentUnits=function(){return c.units},this.hidePanel=function(){N?N.setVisible(!1):o.dispatchEvent({type:a.Events.CLOSE_CALIBRATION_PANEL_EVENT})},this.showPanel=function(){var e=this,t=this.getWindow();N?(t.setTimeout((function(){N.requestedSizeTextbox.focus()}),0),N.setVisible(!0),N.updatePanelPosition(l.indicator.labelPosition,l.indicator.p1,l.indicator.p2,l.indicator.calibrationLabel.clientHeight),e.addWindowEventListener("keyup",(function t(i){"Escape"==(i.key||String.fromCharCode(i.keyCode))&&e.isActive()&&(e.hidePanel(),e.clearSize(),e.showAddCalibrationLabel(),e.removeWindowEventListener("keyup",t))}))):o.dispatchEvent({type:a.Events.OPEN_CALIBRATION_PANEL_EVENT,data:{size:A,units:y}})},this.showAddCalibrationLabel=function(){l.indicator.showAddCalibrationLabel()},this.isCalibrated=function(){return d},this.clearSize=function(){l.indicator.updateLabelValue(null),N?N.requestedSizeTextbox.value="":o.dispatchEvent({type:a.Events.CLEAR_CALIBRATION_SIZE_EVENT})},this.getMaxPrecision=function(){return u},this.clearMeasurement=function(){O(),this.clearPick(1),this.clearPick(2),l.indicator.clear(),this.updateViewportId(!0),this.hidePanel(),x=!1},this.clearPick=function(e){l.hasPick(e)&&(l.clearPick(e),l.indicator.hideClick(e))},this.repickEndpoint=function(e){this.clearPick(e),this.editEndpoint(null,e)},this.getSnapper=function(){return p},this._handleMouseEvent=function(e){var t=!1;if(p.isSnapped())(U()||G())&&(this.clearMeasurement(),k=1),p.copyResults(D()),t=!0;else{if(e&&o.model.is2d()){var i=o.container.getBoundingClientRect(),n=e.canvasX||e.clientX-i.left,s=e.canvasY||e.clientY-i.top;n&&s&&(T=a.inverseProject({x:n,y:s},o))}if(L&&l&&!this.isEditingEndpoint&&k===l.getMaxNumberOfPicks()+1)return!0;var r=D();r&&r.clear()}if(this.correctPickPosition(),L&&this._doConsumeSingleClick(t),!G()){var h=this.render();l.hasPick(2)&&(t&=h)}return L&&(l.isComplete()&&t?(v=l.distanceXYZ,this.clearSize(),this.showPanel(),x=!0):(this.hidePanel(),l.indicator.updateLabelValue(null),x=!1)),t},this.updateViewportId=function(t){if(o.model&&o.model.is2d())if(t||G())e.impl.updateViewportId(0),p.setViewportId(null);else if(!b){var i=I().viewportIndex2d||D().viewportIndex2d;e.impl.updateViewportId(i),p&&p.setViewportId(i)}},this._doConsumeSingleClick=function(e){this.updateViewportId(l.isComplete()),l.indicator.clear()},this.handleButtonDown=function(e,t){return s.isMobileDevice()||(g=!0,0!==t||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||(L=!0,P=e.canvasX,B=e.canvasY)),!1},this.handleMouseMove=function(e){return s.isMobileDevice()||(e.canvasX===P&&e.canvasY===B||(L=!1),C=this.isEditingEndpoint,G()||U()||(this.clearPick(k),this._handleMouseEvent(e)),p.indicator.render()),!1},this.restoreMouseListeners=function(){o.toolController.getTool("gestures").controller.enableMouseButtons(!0)},this.handlePressHold=function(e){if(L=!1,s.isTouchDevice())switch(e.type){case"press":return b=!0,U()?this.clearMeasurement():this.clearPick(k),this._handleMouseEvent(e),p.indicator.render(),!0;case"pressup":return L=!0,this.restoreMouseListeners(),R=!R,this.handleSingleClick(e),b=!1,!0}return!1},this.correctPickPosition=function(){var t=D();if(t&&!t.getGeometry()&&T&&(t.geomType=a.SnapType.SNAP_VERTEX,t.geomVertex=T,t.intersectPoint=T),function(){switch(k){case 0:return!1;case 1:return l.hasPick(l.countPicks());case 2:case 3:return l.hasPick(1)}}()){var i=I();a.correctPerpendicularPicks(i,t,e,p)}},this.render=function(){var e=l.computeResult(l.picks,o,p);return l.indicator.render(l.picks,L||x),e},this.editEndpoint=function(e,t){if(k===t)return l.indicator.changeEndpointOnEditStyle(t,!1),void this.undoEditEndpoint();for(var i in k=t,this.isEditingEndpoint=!0,l.indicator.changeEndpointOnEditStyle(t,!0),l.indicator.changeAllEndpointsEditableStyle(!1),l.picks)l.picks.hasOwnProperty(i)&&(M[i]=l.getPick(i).clone());this.updateViewportId(),this.hidePanel(),l.indicator.updateLabelValue(null),x=!1,s.isMobileDevice()||this._handleMouseEvent(e)},this.undoEditEndpoint=function(){for(var e in l.indicator.clear(),l.picks)l.picks.hasOwnProperty(e)&&l.setPick(e,M[e].clone());this.updateViewportId(!0),this.isEditingEndpoint=!1,x=!0,z(),this.render()&&this.showPanel()},this.handleGesture=function(e){if(s.isTouchDevice()&&(L=!1,b))switch(this.clearPick(k),e.type){case"dragstart":case"dragmove":return this._handleMouseEvent(e),p.indicator.render(),!0;case"dragend":return b=!1,L=!0,this.editByDrag||(R=!R,this.handleSingleClick(e)),this.editByDrag=!1,this.restoreMouseListeners(),!0;case"pinchend":return L=!0,R=!R,this.handleSingleClick(e),this.restoreMouseListeners(),!0}return!1},this.handleButtonUp=function(e){return g=!1,P=null,B=null,C&&(L=!0,R=!R,this.handleSingleClick(e),C=!1),!1},this.handleSingleClick=function(e){return L&&(p.indicator.clearOverlays(),l.indicator.changeEndpointOnEditStyle(k,!1),this._handleMouseEvent(e)?(l.indicator.showEndpoints(),l.indicator.updateLabelsPosition(),k++):this.isEditingEndpoint?this.undoEditEndpoint():this.clearMeasurement(),l.isComplete()&&z(),L=!1,R=!R,this.isEditingEndpoint=!1,p.clearSnapped()),!0},this.handleDoubleClick=function(){return!0},this.handleSingleTap=function(e){return R||(L=!0,p.onMouseDown({x:e.canvasX,y:e.canvasY}),this.handleSingleClick(e)),R=!R,!0},this.handleDoubleTap=function(){return!0},this.handleResize=function(){l.indicator&&l.indicator.handleResize()},this.onCameraChange=function(){p.indicator&&p.indicator.onCameraChange()},this.screenSizeChanged=function(e){this.onCameraChange()}};X.GlobalManagerMixin.call(_.prototype);var J=Autodesk.Viewing,q=function(e){var t=e,i=!1,n=["magnifyingGlass"],s=!1,a=null,r=null,o=null,l=null,h=null,c=!1,u=Autodesk.Viewing;this.setGlobalManager(e.globalManager),this.isActive=function(){return i},this.activate=function(){i=!0,this.updateMagnifyingGlassBinded=this.updateMagnifyingGlass.bind(this)},this.updateMagnifyingGlass=function(){var e=this.getWindow(),i=this.getDocument();if(c)a&&a.classList.remove("visible"),c=!1;else{var n=e.devicePixelRatio,s=120*n,u=n*(l-30),d=n*(h-30);a||((a=i.createElement("canvas")).className="magnifying-glass",a.width=s,a.height=s,a.style.width="120px",a.style.height="120px",a.getContext("2d").translate(0,s),a.getContext("2d").scale(1,-1),t.container.appendChild(a),r=a.getContext("2d").createImageData(Math.ceil(s/2),Math.ceil(s/2)),o=new Uint8Array(r.data.buffer));var p=a.getContext("2d"),m=t.canvas.getContext("webgl2")||t.canvas.getContext("webgl")||t.canvas.getContext("experimental-webgl");m.readPixels(u,t.canvas.height-d-r.height,r.width,r.height,m.RGBA,m.UNSIGNED_BYTE,o),p.putImageData(r,0,0),p.drawImage(a,0,0,r.width,r.height,0,0,s,s),this.setGlassPosition(a,l,h,120,15),a.classList.toggle("visible",!0)}},this.deactivate=function(){this.clearMagnifyingGlass(),i=!1},this.getNames=function(){return n},this.getName=function(){return n[0]},this.getPriority=function(){return 70},this.setGlassPosition=function(e,t,i,n,s){e.style.left=t-n/2+"px",e.style.top=i-n-s>0?i-n-s+"px":i+s+"px"},this.requestUpdate=function(){t.hasEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.updateMagnifyingGlassBinded)||t.addEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.updateMagnifyingGlassBinded,{once:!0})},this.drawMagnifyingGlass=function(e,i){l=e,h=i,t.impl.invalidate(!1,!1,!0),this.requestUpdate()},this.clearMagnifyingGlass=function(){c=!0,this.requestUpdate()},this.handlePressHold=function(e){if(u.isTouchDevice())switch(e.type){case"press":s=!0,this.drawMagnifyingGlass(e.canvasX,e.canvasY);break;case"pressup":this.clearMagnifyingGlass(),s=!1}return!1},this.handleGesture=function(e){if(s&&u.isTouchDevice())switch(e.type){case"dragstart":case"dragmove":this.drawMagnifyingGlass(e.canvasX,e.canvasY);break;case"dragend":this.clearMagnifyingGlass(),s=!1;break;case"pinchstart":case"pinchmove":this.drawMagnifyingGlass(e.canvasX,e.canvasY);break;case"pinchend":this.clearMagnifyingGlass()}return!1},this.handleMouseMove=function(e){return!1},this.handleWheelInput=function(e){return!1},this.handleButtonUp=function(e,t){return!1}};J.GlobalManagerMixin.call(q.prototype);var K=Autodesk.Viewing,$=Autodesk.Viewing.UI,ee=Autodesk.Viewing.Private,te=Autodesk.Viewing.MeasureCommon;function ie(e){this.measureExtension=e,this.measureTool=this.measureExtension.measureTool,this.viewer=this.measureExtension.viewer,this.setGlobalManager(this.viewer.globalManager),this.visible=!1,this.buttonsList=[]}var ne=ie.prototype;K.GlobalManagerMixin.call(ie.prototype),ne.init=function(){var e=this,t=this.getDocument(),i=this.viewer.getToolbar(),n=i.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID),s={};s.index=i.indexOf(n)+1,this.measureToolbar=new $.ControlGroup(Autodesk.Viewing.TOOLBAR.MEASURETOOLSID),this.measureToolbar.setGlobalManager(this.globalManager),i.addControl(this.measureToolbar,s),this.measureSimpleDistanceBtn=new $.Button("toolbar-measureTool-simple-distance"),this.measureSimpleDistanceBtn.setGlobalManager(this.globalManager),this.measureSimpleDistanceBtn.setToolTip("Distance"),this.measureSimpleDistanceBtn.setIcon("adsk-icon-measure-distance-new"),this.measureSimpleDistanceBtn.onClick=function(){e.measureSimpleDistanceBtn.getState()!==$.Button.State.ACTIVE?e.measureExtension.activate("distance"):e.measureTool.deselectAllMeasurements()},this.measureToolbar.addControl(this.measureSimpleDistanceBtn),this.buttonsList[te.MeasurementTypes.MEASUREMENT_DISTANCE]=this.measureSimpleDistanceBtn,this.measureAngleBtn=new $.Button("toolbar-measureTool-angle"),this.measureAngleBtn.setGlobalManager(this.globalManager),this.measureAngleBtn.setToolTip("Angle"),this.measureAngleBtn.setIcon("adsk-icon-measure-angle-new"),this.measureAngleBtn.onClick=function(){e.measureAngleBtn.getState()!==$.Button.State.ACTIVE?e.measureExtension.activate("angle"):e.measureTool.deselectAllMeasurements()},this.measureToolbar.addControl(this.measureAngleBtn),this.buttonsList[te.MeasurementTypes.MEASUREMENT_ANGLE]=this.measureAngleBtn,this.viewer.model&&this.viewer.model.is2d()&&(this.measureAreaBtn=new $.Button("toolbar-measureTool-area"),this.measureAreaBtn.setGlobalManager(this.globalManager),this.measureAreaBtn.setToolTip("Area"),this.measureAreaBtn.setIcon("adsk-icon-measure-area-new"),this.measureAreaBtn.onClick=function(){e.measureAreaBtn.getState()!==$.Button.State.ACTIVE?e.measureExtension.activate("area"):e.measureTool.deselectAllMeasurements()},this.measureToolbar.addControl(this.measureAreaBtn),this.buttonsList[te.MeasurementTypes.MEASUREMENT_AREA]=this.measureAreaBtn),this.calibrationToolBtn=new $.Button("toolbar-calibrationTool"),this.calibrationToolBtn.setGlobalManager(this.globalManager),this.calibrationToolBtn.setToolTip("Calibrate"),this.calibrationToolBtn.setIcon("adsk-icon-measure-calibration"),this.calibrationToolBtn.onClick=function(t){e.calibrationToolBtn.getState()!==$.Button.State.ACTIVE?e.measureExtension.activate("calibrate"):e.measureExtension.enableCalibrationTool(!1)},this.measureToolbar.addControl(this.calibrationToolBtn),this.buttonsList[te.MeasurementTypes.CALIBRATION]=this.calibrationToolBtn;var a=t.createElement("div");a.className="measure-toolbar-seperator",this.measureToolbar.container.appendChild(a),this.deleteBtn=new $.Button("toolbar-delete"),this.deleteBtn.setGlobalManager(this.globalManager),this.deleteBtn.setToolTip("Delete measurement"),this.deleteBtn.setIcon("adsk-icon-measure-trash"),this.deleteBtn.onClick=function(){e.measureExtension.deleteCurrentMeasurement()},this.measureToolbar.addControl(this.deleteBtn),this.settingsBtn=new $.Button("toolbar-settings"),this.settingsBtn.setGlobalManager(this.globalManager),this.settingsBtn.setToolTip("Measure settings"),this.settingsBtn.setIcon("adsk-icon-measure-settings"),this.settingsControlPanel=t.createElement("div"),this.settingsControlPanel.classList.add("docking-panel"),this.settingsControlPanel.classList.add("docking-panel-container-solid-color-b"),this.settingsControlPanel.classList.add("measure-settings-popup"),this.settingsControlPanel.classList.add("hide"),this.settingsBtn.onClick=function(e){this.settingsControlPanel.classList.contains("hide")?(this.settingsControlPanel.classList.remove("hide"),this.setButtonActive(this.settingsBtn)):(this.settingsControlPanel.classList.add("hide"),this.setButtonInactive(this.settingsBtn))}.bind(this),this.measureToolbar.container.appendChild(this.settingsControlPanel),this.settingsControlPanel.root=this.settingsBtn,this.measureToolbar.addControl(this.settingsBtn),this.table=t.createElement("table"),this.table.classList.add("adsk-lmv-tftable"),this.table.classList.add("calibration-table"),this.tbody=t.createElement("tbody"),this.table.appendChild(this.tbody),this.settingsControlPanel.appendChild(this.table),this.units=[{name:"Unknown",units:"",matches:[""]},{name:"Decimal feet",units:"decimal-ft",matches:["ft","decimal-ft"]},{name:"Feet and fractional inches",units:"ft-and-fractional-in",matches:["ft-and-fractional-in"]},{name:"Feet and decimal inches",units:"ft-and-decimal-in",matches:["ft-and-decimal-in"]},{name:"Decimal inches",units:"decimal-in",matches:["in","decimal-in"]},{name:"Fractional inches",units:"fractional-in",matches:["fractional-in"]},{name:"Meters",units:"m",matches:["m"]},{name:"Centimeters",units:"cm",matches:["cm"]},{name:"Millimeters",units:"mm",matches:["mm"]},{name:"Meters and centimeters",units:"m-and-cm",matches:["m-and-cm"]},{name:"Points",units:"pt",matches:["pt"]}];var r=this.findUnits(),o=[];K.isSafari()&&this.viewer.model.getDisplayUnit()&&this.units.shift();for(var l=0;l<this.units.length;++l)o.push(this.units[l].name);this.unitList=new ee.OptionDropDown("Unit type",this.tbody,o,r,null,{paddingLeft:0,paddingRight:15}),this.unitList.setGlobalManager(this.globalManager),this.unitList.addEventListener("change",(function(t){var i=e.unitList.selectedIndex,n=e.units[i].units;e.measureTool.setUnits(n),e.setupPrecision(),ee.logger.track({category:"pref_changed",name:"measure/units",value:n})})),this.precisionList=new ee.OptionDropDown("Precision",this.tbody,[],-1,null,{paddingLeft:0,paddingRight:15}),this.precisionList.setGlobalManager(this.globalManager),this.precisionList.addEventListener("change",(function(t){var i=e.precisionList.selectedIndex;e.measureTool.setPrecision(i),ee.logger.track({category:"pref_changed",name:"measure/precision",value:i})})),this.isolate=new ee.OptionCheckbox("Isolate measurement",this.tbody,!1),this.isolate.setGlobalManager(this.globalManager),this.isolate.addEventListener("change",(function(t){var i=e.isolate.checked;e.measureTool.setIsolateMeasure(i),i?e.measureTool.isolateMeasurement():e.measureTool.clearIsolate(),ee.logger.track({category:"pref_changed",name:"measure/isolate",value:i})})),this.freeMeasure=new ee.OptionCheckbox("Enable free measure",this.tbody,this.measureExtension.isFreeMeasureMode()),this.freeMeasure.setGlobalManager(this.globalManager),this.freeMeasure.addEventListener("change",(function(t){var i=e.freeMeasure.checked;e.measureExtension.setFreeMeasureMode(i),ee.logger.track({category:"pref_changed",name:"measure/freeMeasure",value:i})})),this.setupPrecision(),this.updateSettingsPanel(),this.viewer.model&&this.viewer.model.is2d()&&this.isolate.setVisibility(!1),this.measureExtension.sharedMeasureConfig.units?Autodesk.Viewing.isSafari()||this.disableUnitOption(0):this.disableUnitOption(),this.measureDoneBtn=new $.Button("toolbar-measureTool-done"),this.measureDoneBtn.setGlobalManager(this.globalManager);var h=Autodesk.Viewing.i18n.translate("Done");this.measureDoneBtn.setToolTip(h);var c=t.createElement("label");c.textContent=h;var u=this.measureDoneBtn.container;u.appendChild(c),u.classList.add("adsk-label-button");var d=u.getElementsByClassName("adsk-button-icon");d&&d[0]&&(d[0].style.display="none"),this.measureDoneBtn.onClick=function(){this.measureExtension.exitMeasurementMode()}.bind(this),this.measureToolbar.addControl(this.measureDoneBtn),this.measureToolbar.setVisible(!1)},ne.destroy=function(){this.visible&&this.closeToolbar(),this.measureToolbar&&(this.measureToolbar.removeFromParent(),this.measureToolbar=null)},ne.closeToolbar=function(){this.measureExtension.enableMeasureTool(!1),this.measureExtension.enableCalibrationTool(!1),this.toggleVisible();for(var e=this.viewer.getToolbar(),t=e.container,i=t.children.length,n=0;n<i;++n)t.children[n].style.display="";e.getControl(K.TOOLBAR.MODELTOOLSID).addControl(this.measureExtension.measurementToolbarButton,{index:this.measureExtension.measurementToolbarButton.index})},ne.toggleVisible=function(){this.visible=!this.visible,this.measureToolbar.setVisible(this.visible),this.visible||(this.settingsControlPanel.classList.add("hide"),this.setButtonInactive(this.settingsBtn))},ne.setButtonActive=function(e){e.setState($.Button.State.ACTIVE)},ne.setButtonInactive=function(e){e.setState($.Button.State.INACTIVE)},ne.deactivateAllButtons=function(){for(var e in this.buttonsList)if(this.buttonsList.hasOwnProperty(e)){var t=this.buttonsList[e];this.setButtonInactive(t)}},ne.activateButtonByType=function(e){this.setButtonActive(this.buttonsList[e])},ne.setupPrecision=function(){for(var e=this.getDocument();this.precisionList.dropdownElement.lastChild;)this.precisionList.dropdownElement.removeChild(this.precisionList.dropdownElement.lastChild);var t,i=this.measureTool.getUnits();t="ft-and-fractional-in"===i||"fractional-in"===i?["1","1/2","1/4","1/8","1/16","1/32","1/64"]:["0","0.1","0.01","0.001","0.0001","0.00001"];for(var n=0;n<t.length;++n){var s=e.createElement("option");s.value=n,s.textContent=t[n],this.precisionList.dropdownElement.appendChild(s)}var a=this.measureTool.getPrecision();t.length<=a&&(a=t.length-1,this.measureTool.setPrecision(a)),this.precisionList.dropdownElement.selectedIndex=a},ne.findUnits=function(){var e,t,i=this.measureTool.getUnits();for(e=0;e<this.units.length;++e){var n=this.units[e].matches;if(n)for(t=0;t<n.length;++t)if(n[t]===i)return e}return 0},ne.disableUnitOption=function(e){null!=e?(this.unitList.dropdownElement.children[e].style.display="none",K.isIE11&&(this.unitList.dropdownElement.children[e].disabled=!0,this.unitList.dropdownElement.children[e].style.visibility="hidden")):this.unitList.dropdownElement.disabled=!0},ne.updateSettingsPanel=function(){this.unitList.dropdownElement.selectedIndex=this.findUnits(),this.precisionList.dropdownElement.selectedIndex=this.measureTool.getPrecision(),this.setupPrecision()};i(344),i(347);function se(e,t,i,n,s,a,r){try{var o=e[a](r),l=o.value}catch(e){return void i(e)}o.done?t(l):Promise.resolve(l).then(n,s)}function ae(e){return function(){var t=this,i=arguments;return new Promise((function(n,s){var a=e.apply(t,i);function r(e){se(a,n,s,r,o,"next",e)}function o(e){se(a,n,s,r,o,"throw",e)}r(void 0)}))}}i.d(t,"MeasureExtension",(function(){return de}));var re=AutodeskNamespace("Autodesk.Viewing.Extensions.Measure"),oe=Autodesk.Viewing,le=Autodesk.Viewing.Private,he=oe.UI,ce=Autodesk.Viewing.MeasureCommon,ue=ce.MeasurementTypes.MEASUREMENT_DISTANCE,de=function(e,t){Autodesk.Viewing.Extension.call(this,e,t),this.modes=["distance","angle","area","calibrate"],this.name="measure",this._onModelLoaded=this._onModelLoaded.bind(this)};de.prototype=Object.create(Autodesk.Viewing.Extension.prototype),de.prototype.constructor=de,de.prototype.load=ae(regeneratorRuntime.mark((function e(){var t,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.viewer.loadExtension("Autodesk.Snapping");case 2:if(t=this,i=this.viewer,this.hasUI=Autodesk.Viewing.GuiViewer3D&&i instanceof Autodesk.Viewing.GuiViewer3D,this.escapeHotkeyId="Autodesk.Measure.Hotkeys.Escape",i.toolController){e.next=8;break}return e.abrupt("return",!1);case 8:this.options=this.options||{},(n={}).onCloseCallback=function(){t.enableMeasureTool(!1)},this.sharedMeasureConfig={units:null,precision:null,calibrationFactor:null},n.snapperOptions=this.options.snapperOptions,this.forceCalibrate=this.options.forceCalibrate,this.snapper=new Autodesk.Viewing.Extensions.Snapping.Snapper(i,{renderSnappedTopology:!0}),i.toolController.registerTool(this.snapper),this.measureTool=new k(i,n,this.sharedMeasureConfig,this.snapper),i.toolController.registerTool(this.measureTool),this.calibrationTool=new _(i,this.options,this.sharedMeasureConfig,this.snapper),i.toolController.registerTool(this.calibrationTool),this.magnifyingGlass=new q(i),i.toolController.registerTool(this.magnifyingGlass),this.calibration={},this.onFinishedCalibration=function(e){t.measureToolbar&&t.measureToolbar.updateSettingsPanel(),t.activateInitiator&&t.activateInitiator(),t.calibration.units=e.units,t.calibration.scaleFactor=e.scaleFactor,t.calibration.size=e.size,t.calibration.precision=t.sharedMeasureConfig.precision},i.addEventListener("finished-calibration",this.onFinishedCalibration),this.onMeasurementChanged=function(e){var i=e.data.type;t.changeMeasurementType(i)},i.addEventListener(ce.Events.MEASUREMENT_CHANGED_EVENT,this.onMeasurementChanged),i.model?this._onModelLoaded({model:i.model}):i.addEventListener(oe.MODEL_ROOT_LOADED_EVENT,this._onModelLoaded,{once:!0}),this.onModelRemoved=function(){t.measurementToolbarButton&&(t.viewer.model||(t.measurementToolbarButton.setState(Autodesk.Viewing.UI.Button.State.DISABLED),t.exitMeasurementMode()))},this.onModelAdded=function(){t.measurementToolbarButton&&(1===t.viewer.getVisibleModels().length&&t.measurementToolbarButton&&t.measurementToolbarButton.setState(Autodesk.Viewing.UI.Button.State.INACTIVE))},i.addEventListener(oe.MODEL_ADDED_EVENT,this.onModelAdded),i.addEventListener(oe.MODEL_REMOVED_EVENT,this.onModelRemoved);case 32:case"end":return e.stop()}}),e,this)}))),de.prototype._onModelLoaded=function(e){var t=e.model,i=!!t.getData().isPdf&&!this.viewer.prefs.get(le.Prefs2D.FORCE_PDF_CALIBRATION),n=!!t.getData().isLeaflet&&!this.viewer.prefs.get(le.Prefs2D.FORCE_LEAFLET_CALIBRATION);this.sharedMeasureConfig.units=this.options.calibrationUnits||t.getDisplayUnit(),!i&&!n||t.getMetadata("page_dimensions","model_units",null)||(this.sharedMeasureConfig.units="pt"),this.sharedMeasureConfig.precision=t.is2d()?3:1,this.options.calibrationUnits&&!isNaN(this.options.calibrationFactor)&&this.calibrationTool.calibrateByScale(this.options.calibrationUnits,this.options.calibrationFactor)},de.prototype.unload=function(){var e=this.viewer;return this.destroyUI(),e.removeEventListener("finished-calibration",this.onFinishedCalibration),e.removeEventListener(ce.Events.MEASUREMENT_CHANGED_EVENT,this.onMeasurementChanged),e.removeEventListener(oe.MODEL_ADDED_EVENT,this.onModelAdded),e.removeEventListener(oe.MODEL_REMOVED_EVENT,this.onModelRemoved),e.removeEventListener(oe.MODEL_ROOT_LOADED_EVENT,this._onModelLoaded),e.toolController.deregisterTool(this.snapper),this.snapper=null,e.toolController.deregisterTool(this.measureTool),this.measureTool=null,e.toolController.deregisterTool(this.calibrationTool),this.calibrationTool=null,e.toolController.deregisterTool(this.magnifyingGlass),this.magnifyingGlass=null,this.unloaded=!0,!0},de.prototype.setActive=function(e){return this.enableMeasureTool(e)},de.prototype.toggle=function(){return this.isActive()?this.enableMeasureTool(!1):this.enableMeasureTool(!0),this.isActive()},de.prototype.getMeasurement=function(e,t){var i=null;return this.measureTool.isActive()&&(i=this.measureTool.getMeasurement(e,t)),i},de.prototype.getMeasurementList=function(e,t){var i=[];return this.measureTool.isActive()&&(i=this.measureTool.getMeasurementList(e,t)),i},de.prototype.setMeasurements=function(e){this.measureTool.isActive()&&this.measureTool.setMeasurements(e)},de.prototype.getUnitOptions=function(){return[{name:"Unknown",type:""},{name:"Decimal feet",type:"decimal-ft"},{name:"Feet and fractional inches",type:"ft"},{name:"Feet and decimal inches",type:"ft-and-decimal-in"},{name:"Decimal inches",type:"decimal-in"},{name:"Fractional inches",type:"fractional-in"},{name:"Meters",type:"m"},{name:"Centimeters",type:"cm"},{name:"Millimeters",type:"mm"},{name:"Meters and centimeters",type:"m-and-cm"},{name:"Points",type:"pt"}]},de.prototype.getPrecisionOptions=function(e){return e?["1","1/2","1/4","1/8","1/16","1/32","1/64"]:["0","0.1","0.01","0.001","0.0001","0.00001"]},de.prototype.getDefaultUnit=function(){return this.viewer.model.getDisplayUnit()},de.prototype.openCalibrationRequiredDialog=function(e){this.hasUI?(this.CalibrationRequiredDialog||(this.CalibrationRequiredDialog=new Q(this,this.viewer,"calibration-required","Calibration Required",this.options)),this.CalibrationRequiredDialog.setVisible(!0)):this.viewer.dispatchEvent({type:ce.Events.CALIBRATION_REQUIRED_EVENT}),"measure"===e?this.activateInitiator=function(){this.enableMeasureTool(!0,ue),this.activateInitiator=null}:"dimension"===e&&(this.activateInitiator=function(){this.viewer.dispatchEvent({type:ce.Events.FINISHED_CALIBRATION_FOR_DIMENSION_EVENT}),this.activateInitiator=null})},de.prototype.getCalibration=function(){return this.calibration},de.prototype.activate=function(e){if(this.activeStatus&&this.mode===e)return!0;var t;switch(this.enterMeasurementMode(),e){default:e="distance";case"distance":t=this.enableMeasureTool(!0,ce.MeasurementTypes.MEASUREMENT_DISTANCE);break;case"angle":t=this.enableMeasureTool(!0,ce.MeasurementTypes.MEASUREMENT_ANGLE);break;case"area":this.viewer.model.is2d()?t=this.enableMeasureTool(!0,ce.MeasurementTypes.MEASUREMENT_AREA):console.warn("Area mode is applicable on 2D models only");break;case"calibrate":t=this.enableCalibrationTool(!0)}return this.mode=t?e:"",this.activeStatus=!0,!0},de.prototype.deactivate=function(){return this.activeStatus&&(this.exitMeasurementMode(),this.enableMeasureTool(!1),this.activeStatus=!1),!0},de.prototype.setForcePDFCalibrate=function(e){this.viewer.prefs.set(le.Prefs2D.FORCE_PDF_CALIBRATION,e)},de.prototype.setForceLeafletCalibrate=function(e){this.viewer.prefs.set(le.Prefs2D.FORCE_LEAFLET_CALIBRATION,e)},de.prototype.setRestoreSessionMeasurements=function(e){this.viewer.prefs.set(le.Prefs.RESTORE_SESSION_MEASUREMENTS,e)},de.prototype.enableMeasureTool=function(e,t){if(t===ce.MeasurementTypes.MEASUREMENT_AREA&&this.viewer.model&&!this.viewer.model.is2d())return!1;var i=this.viewer.toolController,n=1===this.selectedTool;if(!this.viewer.model||!e&&n)return this.measureTool.isActive()&&(i.deactivateTool("measure"),this.measureToolbar&&this.measureToolbar.deactivateAllButtons(),this.selectedTool=0),!0;var s=this.viewer.model.getData().isPdf&&this.viewer.prefs.get(le.Prefs2D.FORCE_PDF_CALIBRATION),a=this.viewer.model.getData().isLeaflet&&this.viewer.prefs.get(le.Prefs2D.FORCE_LEAFLET_CALIBRATION);return this.forceCalibrate|=a||s,t||(t=ue),e&&!n?(this.checkAndFetchTopology(i.getTool("measure")),!this.forceCalibrate||this.forceCalibrate&&this.calibrationTool.isCalibrated()||t===ce.MeasurementTypes.MEASUREMENT_ANGLE?(this.calibrationTool.isActive()&&i.deactivateTool("calibration"),this.measureToolbar&&this.measureToolbar.updateSettingsPanel(),i.activateTool("measure"),this.selectedTool=1,this.changeMeasurementType(t),!0):(this.viewer.addEventListener(re.OPEN_TOOL_AFTER_CALIBRAION,function(){this.enableMeasureTool(!0)}.bind(this),{once:!0}),this.openCalibrationRequiredDialog("measure"),!1)):!(!e||!n)&&(!this.forceCalibrate||this.forceCalibrate&&this.calibrationTool.isCalibrated()||t===ce.MeasurementTypes.MEASUREMENT_ANGLE?(this.changeMeasurementType(t),!0):(this.openCalibrationRequiredDialog("measure"),!1))},de.prototype.changeMeasurementType=function(e){switch(this.measureTool.changeMeasurementType(e),this.measureToolbar&&(this.measureToolbar.deactivateAllButtons(),this.measureToolbar.activateButtonByType(e)),e){case ce.MeasurementTypes.MEASUREMENT_DISTANCE:this.mode="distance";break;case ce.MeasurementTypes.MEASUREMENT_ANGLE:this.mode="angle";break;case ce.MeasurementTypes.MEASUREMENT_AREA:this.mode="area";break;default:this.mode=""}},de.prototype.setIsolateMeasure=function(e){this.measureTool.setIsolateMeasure(e),e?this.measureTool.isolateMeasurement():this.measureTool.clearIsolate()},de.prototype.enableCalibrationTool=function(e){var t=this.viewer.toolController,i=2==this.selectedTool;return e&&!i?(this.measureTool.isActive()&&t.deactivateTool("measure"),t.activateTool("calibration"),this.viewer.dispatchEvent({type:ce.Events.UNITS_CALIBRATION_STARTS_EVENT}),this.measureToolbar&&(this.measureToolbar.deactivateAllButtons(),this.measureToolbar.activateButtonByType(ce.MeasurementTypes.CALIBRATION)),this.selectedTool=2,!0):!(e||!i)&&(this.calibrationTool.isActive()&&(this.mode="",t.deactivateTool("calibration"),this.measureToolbar&&this.measureToolbar.deactivateAllButtons()),this.selectedTool=0,!0)},de.prototype.enterMeasurementMode=function(){if(!this._measurementMode&&(this._measurementMode=!0,this.viewer.dispatchEvent({type:ce.Events.MEASUREMENT_MODE_ENTER}),this.viewer.getToolbar)){for(var e=this.viewer.getToolbar(),t=e.container,i=t.children.length,n=0;n<i;++n)t.children[n].style.display="none";this.navigationControls=e.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID),this.navigationControls.setVisible(!0),this.navigationControls.container.style.display="",this.measureControls=e.getControl(Autodesk.Viewing.TOOLBAR.MEASURETOOLSID),this.measureControls.setVisible(!0),this.measureControls.container.style.display="";var s=this.measurementToolbarButton.getId();this.measurementToolbarButton.index=this.measurementToolbarButton.parent.indexOf(s),this.measurementToolbarButton.parent.removeControl(s),this.measureToolbar.toggleVisible(),this.viewer.centerToolBar&&this.viewer.centerToolBar(),this.enableMeasureTool(!0,ue)}},de.prototype.exitMeasurementMode=function(){this._measurementMode&&(this.viewer.dispatchEvent({type:ce.Events.MEASUREMENT_MODE_LEAVE}),this.measureToolbar&&this.measureToolbar.closeToolbar(),this.CalibrationRequiredDialog&&this.CalibrationRequiredDialog.isVisible()&&this.CalibrationRequiredDialog.setVisible(!1),this._measurementMode=!1)},de.prototype.onToolbarCreated=function(e){if(!this.measureToolbar){var t=this,i=this.viewer,n=e.getControl(oe.TOOLBAR.MODELTOOLSID);this.measurementToolbarButton=new he.Button("toolbar-measurementSubmenuTool"),this.measurementToolbarButton.setToolTip("Measure"),this.measurementToolbarButton.setIcon("adsk-icon-measure"),n.measurementToolbarButton=this.measurementToolbarButton,n.addControl(this.measurementToolbarButton,{index:0});var s=this.viewer.model?Autodesk.Viewing.UI.Button.State.INACTIVE:Autodesk.Viewing.UI.Button.State.DISABLED;this.measurementToolbarButton.setState(s),this.measureToolbar=new ie(this),this.measureToolbar.init(),this.measurementToolbarButton.onClick=this.activate.bind(this);var a=[{keycodes:[Autodesk.Viewing.KeyCode.ESCAPE],onRelease:function(){if(t._measurementMode)return t.exitMeasurementMode(),!0}}];i.getHotkeyManager().pushHotkeys(this.escapeHotkeyId,a)}},de.prototype.checkAndFetchTopology=function(e){this._checkedTopology||(this._checkedTopology=!0,this.viewer.model.is3d()?this.viewer.modelHasTopology()?e&&e.setTopologyAvailable():(e&&e.setFetchingTopology(),this.viewer.model.fetchTopology().then((function(t){e&&e.setTopologyAvailable()})).catch((function(t){le.logger.log(t),e&&e.setNoTopology()}))):e&&e.setNoTopology())},de.prototype.destroyUI=function(){var e=this.viewer;this.measureToolbar&&(this.measureToolbar.destroy(),this.measureToolbar=null),this.measurementToolbarButton&&(this.measurementToolbarButton.removeFromParent(),this.measurementToolbarButton=null),e.getHotkeyManager().popHotkeys(this.escapeHotkeyId)},de.prototype.setUnits=function(e){this.measureTool.setUnits(e)},de.prototype.getUnits=function(){return this.measureTool.getUnits()},de.prototype.setPrecision=function(e){this.measureTool.setPrecision(e)},de.prototype.getPrecision=function(){return this.measureTool.getPrecision()},de.prototype.calibrate=function(e,t){this.calibrationTool.calibrate(e,t)},de.prototype.calibrateByScale=function(e,t){this.calibrationTool.calibrateByScale(e,t)},de.prototype.isCalibrationValid=function(e,t){return this.calibrationTool.isCalibrationValid(e,t)},de.prototype.getCalibrationFactor=function(){return this.calibrationTool.getCalibrationFactor()},de.prototype.showAddCalibrationLabel=function(){this.calibrationTool.showAddCalibrationLabel()},de.prototype.deleteMeasurements=function(){this.measureTool.deleteMeasurements()},de.prototype.deleteCurrentMeasurement=function(){this.measureTool.deleteCurrentMeasurement()},de.prototype.selectMeasurementById=function(e){this.measureTool.selectMeasurementById(e)},de.prototype.setFreeMeasureMode=function(e){this.snapper.setSnapToPixel(e)},de.prototype.isFreeMeasureMode=function(){return this.snapper.getSnapToPixel()},oe.theExtensionManager.registerExtension("Autodesk.Measure",de)},6:function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var i=t.protocol+"//"+t.host,n=i+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var s,a=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?e:(s=0===a.indexOf("//")?a:0===a.indexOf("/")?i+a:n+a.replace(/^\.\//,""),"url("+JSON.stringify(s)+")")}))}}});
//# sourceMappingURL=Measure.min.js.map